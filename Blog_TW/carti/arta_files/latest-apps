var Antavo={};(function(){var encode=encodeURIComponent;function merge(source,dest){if(typeof Object.assign!='function'){Object.assign=function(target){'use strict';if(target==null){throw new TypeError('Cannot convert undefined or null to object');}
target=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!=null){for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}}
return target;};}
dest=Object.assign({},dest);if(dest===null||dest===undefined||dest===source){return source;}
if(source===null||source===undefined){return dest;}
for(var p in source){if(!source.hasOwnProperty(p)){continue;}
if(source[p]===null){dest[p]=source[p];}else if('object'===typeof source[p]&&!(source[p]instanceof Date)&&!(source[p]instanceof Array)){dest[p]=merge(source[p],dest[p]);}else{dest[p]=source[p];}}
return dest;}
function isIE(){return-1!=navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf('Trident/')>0;}
function isEdge(){return navigator.appVersion.indexOf('Edge')>0;}
function isMobile(){return{Android:function(){return navigator.userAgent.match(/Android/i);},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);},Opera:function(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function(){return navigator.userAgent.match(/IEMobile/i);},any:function(){return(this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows());}}}
function serialize(data,prefix){var result=[],key,value;for(var property in data){if(data.hasOwnProperty(property)){key=prefix?prefix+"["+property+"]":property;value=data[property];result.push("object"==typeof value?serialize(value,key):encode(key)+"="+encode(value));}}
return result.join("&");}
Antavo.isIE=isIE;Antavo.isEdge=isEdge;Antavo.serialize=serialize;Antavo.isMobile=isMobile;Antavo.merge=merge;})();var Antavo=window.Antavo||{};(function(document){var encode=encodeURIComponent;function closest(element,selector,context){if(element&&element.nodeType){while(element){if(element.nodeType!=Node.DOCUMENT_NODE&&element.nodeType!=Node.DOCUMENT_FRAGMENT_NODE){if(matches(element,selector)){return element;}else if(element==context){return null;}else{element=element.parentNode;}}else{return null;}}}
return null;}
function insertAfter(newNode,referenceNode){return referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling);}
function fromString(string){var element;var container=document.createElement("div");var fragment=document.createDocumentFragment();container.innerHTML=string;while(element=container.firstChild){fragment.appendChild(element);}
return fragment;}
function hasClass(element,className){return element.classList?element.classList.contains(className):new RegExp('(^| )'+className+'( |$)','gi').test(element.className);}
function matches(element,selector){return(element.matches||element.matchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.webkitMatchesSelector||element.oMatchesSelector).call(element,selector);}
function serializeForm(form){var data,collection,element;if(form instanceof HTMLFormElement){data=[];collection=form.elements;for(var i=0,length=collection.length;i<length;i++){element=collection[i];if(element.name&&!element.getAttribute("disabled")){if("radio"==element.type||"checkbox"==element.type){if(!element.checked){continue;}}
if("select-multiple"==element.type){for(var c=0;c<element.options.length;c++){if(element.options[c].selected){data.push(encode(element.name)+"="+encode(element.options[c].value));}}}else{data.push(encode(element.name)+"="+encode(element.value));}}}
return data.join("&");}
return"";}
Antavo.DOM={};Antavo.DOM.closest=closest;Antavo.DOM.fromString=fromString;Antavo.DOM.hasClass=hasClass;Antavo.DOM.matches=matches;Antavo.DOM.serializeForm=serializeForm;Antavo.DOM.insertAfter=insertAfter;})(document);var Antavo=window.Antavo||{};Antavo.URL=function(url){"use strict";var decode=decodeURIComponent;var encode=encodeURIComponent;var a=document.createElement("A");a.href=url;function buildQuery(object){var string="",i,c=0;for(i in object){if(object.hasOwnProperty(i)){string+=(c++?'&':'')+encode(i)+'='+encode(object[i]);}}
return string;}
function parseQuery(queryString){var
params={},segments=queryString.split('&'),length=segments.length,i,tmp;for(i=0;i<length;i++){if(segments[i]){tmp=segments[i].split('=');params[decode(tmp[0])]=decode(tmp[1]);}}
return params;}
this.source=url.toString();this.protocol=a.protocol.replace(':','');this.host=a.hostname?a.hostname:location.hostname;this.port=a.port;this.query=a.search;this.params=parseQuery(a.search.replace(/^\?/,''));this.file=(a.pathname.match(/\/([^\/?#]+)$/i)||['',''])[1];this.hash=a.hash.replace('#','');this.path=a.pathname.replace(/^([^\/])/,'/$1');this.relative=(a.href.match(/tps?:\/\/[^\/]+(.+)/)||['',''])[1];this.segments=a.pathname.replace(/^\//,'').split('/');this.toString=function(){var queryString=buildQuery(this.params);return(this.protocol?this.protocol+'://':'//')
+this.host
+(this.port?':'+this.port:'')
+this.path
+(queryString?'?'+queryString:'')
+(this.hash?'#'+this.hash:'');};this.parseQuery=parseQuery;Antavo.URL.buildQuery=buildQuery;Antavo.URL.parseQuery=parseQuery;};var Antavo=window.Antavo||{};Antavo.Event=(function(parent,document){var
closest=parent.DOM.closest,elements=[],events=[];function handle(event){var index=elements.indexOf(this);var selectors;if(-1==index||!events[index]){return;}
if(selectors=events[index][event.type]){for(var selector in selectors){if(selectors.hasOwnProperty(selector)){var target=event.target;while(target=closest(target,selector,this)){for(var i=0,length=selectors[selector].length;i<length;i++){if(false===selectors[selector][i].call(target,event)){break;}}
target=target.parentNode;}}}}}
function bind(type,selector,handler,context){if(!context){context=document;}
if(context.nodeType&&"function"==typeof handler){var index=elements.indexOf(context);if(-1==index){index=elements.push(context);events[--index]={};}
if(!events[index][type]){events[index][type]={};context.addEventListener(type,handle);}
if(!events[index][type][selector]){events[index][type][selector]=[];}
events[index][type][selector].push(handler);return true;}
return false;}
function trigger(element,eventType,detail){var event;if(element){if(parent.isIE()){event=document.createEvent('CustomEvent');event.initCustomEvent(eventType,true,true,detail);}else{event=new CustomEvent(eventType,{bubbles:true,cancelable:true,detail:detail});}
return element.dispatchEvent(event);}}
function unbind(){return false;}
return{bind:bind,trigger:trigger,unbind:unbind};})(Antavo,document);var Antavo=window.Antavo||{};Antavo.AJAX=(function(parent){var Event=parent.Event;var SUBMITTED="antavo_ajax_submitted";var BEFORE_SEND="antavo_ajax_before_send";var SENT="antavo_ajax_sent";var LOADING="antavo_ajax_loading";var COMPLETED="antavo_ajax_completed";var SUCCESS="antavo_ajax_success";var ERROR="antavo_ajax_error";function responseContentTypeIsJson(request){return request.getResponseHeader("Content-Type").indexOf("application/json")>-1;}
function submit(event,callback,errorHandler,context){event.preventDefault();context=context||event.target;Event.trigger(context,SUBMITTED);return send(event.target.method||"GET",event.target.getAttribute("action")||"",parent.DOM.serializeForm(event.target),callback,errorHandler,context);}
function createXMLHttpRequest(method,url,plain){var request;if(window.XMLHttpRequest){request=new XMLHttpRequest();}else if(window.ActiveXObject){request=new ActiveXObject("Microsoft.XMLHTTP");}else{throw new Error("No XMLHttpRequest object found!");}
request.open(method,url,true);if(!plain)request.setRequestHeader("X-Requested-With","XMLHttpRequest");return request;}
function get(url,callback,errorHandler,context,plain){return send("GET",url,null,callback,errorHandler,context,plain);}
function post(url,data,callback,errorHandler,context){return send("POST",url,data,callback,errorHandler,context);}
function send(method,url,data,callback,errorHandler,context,plain){if("string"!=typeof data&&!(data instanceof FormData)){data=parent.serialize(data);}
if(data&&"GET"==method.toUpperCase()){url+=(-1==url.indexOf("?")?"?":"&")+data;data=null;}
var request=createXMLHttpRequest(method,url,plain);request.onreadystatechange=function(){onReadyStateChange(this,callback,errorHandler,context);};if(data){if(data instanceof FormData){}else{request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}}
if(context){Event.trigger(context,BEFORE_SEND,request);}
request.send(data);if(context){Event.trigger(context,SENT,request);}
return request;}
function onReadyStateChange(request,callback,errorHandler,context){switch(request.readyState){case request.UNSENT:break;case request.OPENED:if(context){Event.trigger(context,LOADING,request);}
break;case request.HEADERS_RECEIVED:if(responseContentTypeIsJson(request)){request.responseType="json";}
break;case request.LOADING:break;case request.DONE:receive(request,callback,errorHandler,context);break;}}
function receive(request,callback,errorHandler,context){var response=request.response;if(response&&parent.isIE()&&responseContentTypeIsJson(request)){response=JSON.parse(response);}
if(context){Event.trigger(context,COMPLETED,request);}
if(200==request.status){if(response&&response.error){failure(request,response,errorHandler,context);}else{success(response,callback,context);}}else{failure(request,response,errorHandler,context);}}
function success(response,callback,context){if(context){Event.trigger(context,SUCCESS,response);}
if("function"==typeof callback){callback.call(context||window,response);};}
function failure(request,response,errorHandler,context){if(context){Event.trigger(context,ERROR,request);}
if("function"==typeof errorHandler){errorHandler.call(context||window,request,response);}}
function errorHandler(message,file,line){if(!/script error/i.test(message)){post("https://push.antavo.com/js",{message:message,file:file,line:line});}}
return{get:get,post:post,send:send,submit:submit,errorHandler:errorHandler,SUBMITTED:SUBMITTED,BEFORE_SEND:BEFORE_SEND,SENT:SENT,LOADING:LOADING,COMPLETED:COMPLETED,SUCCESS:SUCCESS,ERROR:ERROR};})(Antavo);var Antavo=window.Antavo||{};var Antavo=window.Antavo||{};Antavo.Cookie=(function(parent){var
encode=encodeURIComponent,persistence=new Date('Fri, 31 Dec 9999 23:59:59 UTC'),defaults={path:'/',expires:persistence};function getExpireDate(expires){var now=new Date();if(typeof expires==='number'){expires=expires===Infinity?defaults.expires:new Date(now.getTime()+expires*1000);}else if(typeof expires==='string'){expires=new Date(expires);}
return expires;}
function get(name){var value=(document.cookie.match("(^|;\\s*)"+
encode(name)+"=([^;]*)")||0)[2];return value!==undefined?decodeURIComponent(value):undefined;}
function set(name,value,expires,path,domain){document.cookie=encode(name)+'='+encode(value)
+(expires?'; expires='+getExpireDate(expires).toUTCString():'')
+'; path='+(path?path:defaults.path)
+(domain?'; domain ='+domain:'');}
function expire(name,value,path,domain){path=path?path:false;domain=domain?domain:false;set(name,value,'Thu, 01 Jan 1970 00:00:00 GMT',path,domain);}
return{get:get,set:set,expire:expire};})(Antavo);var Antavo=window.Antavo||{};Antavo.Template=function(element){function toString(object){if(object.nodeType==Node.DOCUMENT_NODE||object.nodeType==Node.DOCUMENT_FRAGMENT_NODE){var element=document.createElement("div");element.appendChild(object);return element.innerHTML;}
return object.innerHTML||object.toString&&object.toString();}
function replace(string,replacements,ldelim,rdelim){var
str=ldelim+"foreach\\s+(\\w+)"+rdelim+"([\\s\\S]+)"+ldelim+"endforeach"+rdelim,matches=string.match(new RegExp(str,"g")),i;if(matches){for(i in matches){var
submatches=matches[i].match(new RegExp(str)),data=replacements[submatches[1]],substring="";if(data){for(var j in data){substring+=replace(submatches[2],data[j],ldelim,rdelim);}}
string=string.replace(matches[i],substring);}}
for(i in replacements){string=string.replace(new RegExp(ldelim+i+rdelim,"g"),replacements[i]);}
return string;}
this.replace=function(replacements){return this.content=replace(this.content,replacements,this.leftDelimiter,this.rightDelimiter);};this.leftDelimiter="{{";this.rightDelimiter="}}";this.content=toString(element);};var Antavo=window.Antavo||{};(function(document){var x=0;var COOKIE_CUSTOMER="__alc";var COOKIE_GROUP="__alg";var COOKIE_OPTIN="__alo";var OPTIN_PENDING="1";var OPTIN_DONE="2";var OPTIN_CONFIRMED="3";var _API_KEY;var _CUSTOMER_ID;var _CUSTOMER;var _BRAND_ID;var _BRAND_URL;var _FACEBOOK_APP_ID;var _API_URL;var _APPS_URL;var _CDN_URL;var _REVIEWS_URL;var _LOGIN_URL;var _QUIZZES_URL;var socketServer='ws://microsite-bugfix.antavo.local:5000';var apiHost='https://api.st1.antavo.com';var endpoint=apiHost+'/events';var isValid=true;var hasWidget=false;var ready=false;var initCallback;var initCallbackTrigger;var socialHandshake=false;var options;var default_options={auth:{cookie:true,method:'cookie'},video:{enabled:true},social:{enabled:true,disableTracking:false},widget:{enabled:false,template:null,quiz:true,position:'right'},tracking:{autoSend:false,setHash:true,hashMethod:'hash'},socialShare:{enabled:true},notifications:true,locale:null};var extensions;var callbackStack=[];var events={'SDK_INIT_START':'antavo_sdk_init_start','SDK_INIT_FINISHED':'antavo_sdk_init_finished','SDK_INIT_ERROR':'antavo_sdk_init_error','SDK_AUTH_FINISHED':'antavo_sdk_customer_authenticated','SDK_AUTH_NO_CUSTOMER':'antavo_sdk_customer_not_authenticated','MESSAGE_RECEIVED':'antavo_sdk_message_received','SHOW_NOTIFICATION':'antavo_sdk_show_notification','NOTIFICATION_SHOWN':'antavo_sdk_notification_shown'};var REST_AUTH=true;var _L10N={decimalSeparator:".",groupSeparator:","};var websocket;var eventQueue=[];var messageQueue={};var getNextSequenceItem=(function(){var id=1;return function(){return id++;};}());var _KEY_CHANGE=['Got %d points','Get %d points','Will get %d points'];Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var r=Object(e),t=1;t<arguments.length;t++){var n=arguments[t];if(void 0!==n&&null!==n){n=Object(n);for(var o=Object.keys(Object(n)),a=0,c=o.length;c>a;a++){var i=o[a],b=Object.getOwnPropertyDescriptor(n,i);void 0!==b&&b.enumerable&&(r[i]=n[i])}}}return r}});function isReady(){return ready;}
function websocketSend(message){if(websocket&&WebSocket.OPEN==websocket.readyState){websocket.send(JSON.stringify(message));}else{eventQueue.push(message);}}
function init(apiKey,customerId,opts,callback,callbackTrigger){var helperObj={},callbackEvent=callbackTrigger||'init';options=Antavo.merge(opts,default_options);_API_KEY=apiKey;if("cookie"===options.auth.method){_CUSTOMER_ID=customerId;}
if(apiKey&&apiKey!=''){if(REST_AUTH){doApiAuth();}else{initSocketConnection();}
document.addEventListener(events.NOTIFICATION_SHOWN,function(e){if(e.detail.id){websocketSend({type:'delivered',id:e.detail.id});}});window.addEventListener('beforeunload',closeSocketConnection);}
if(Antavo.Toast!==undefined){Antavo.Toast.setEventHandlers();}
if(options.video!==undefined){if(options.video.enabled)Antavo.Video.init();}
ready=true;injectStyleSheet();sendInitEvent();if(callback&&helperObj.toString.call(callback)==='[object Function]'){if(callbackEvent=='init'){callback.call(window);}else{initCallback=callback;initCallbackTrigger=callbackEvent;}}
setKey(getKey('lc_aip_inner_content_past')||getKeys()[0],0);setKey(getKey('lc_aip_inner_content')||getKeys()[1],1);setKey(getKey('lc_aip_inner_content_future')||getKeys()[2],2);return Antavo.SDK;}
function initSocketConnection(){x++;console.info('Initializing socket connection. Attempt: '+x);websocket=new WebSocket(socketServer);websocket.onerror=onSocketError;websocket.onopen=onSocketOpen;websocket.onclose=onSocketClose;websocket.onmessage=onSocketMessage;}
function closeSocketConnection(){if(websocket)websocket.close();}
function sendInitEvent(){if(typeof Antavo.Widget!='undefined'){if(!Antavo.Widget.isReady()){Antavo.Widget.setTemplate(options.widget.template);}
if(Antavo.Widget.isReady()&&Antavo.SDK.isReady()){Antavo.Event.trigger(document,events.SDK_INIT_FINISHED,{});}}else{if(Antavo.SDK.isReady()){Antavo.Event.trigger(document,events.SDK_INIT_FINISHED,{});}}}
function doApiAuth(){var url='https://api.st1.antavo.com/auth?api_key='+_API_KEY;if(options&&options.locale&&options.locale!=null){url+='&locale='+options.locale;}
if(_CUSTOMER_ID&&_CUSTOMER_ID!=''){url+='&customer='+_CUSTOMER_ID;}
Antavo.AJAX.get(url,function(msg){var guestCustomer=true;if(msg.length>0){for(var i=0;i<msg.length;i++){handleMessage(msg[i]);if(msg[i].type==='customer'){guestCustomer=false;}}
if(guestCustomer){Antavo.Event.trigger(document,events.SDK_AUTH_NO_CUSTOMER,{});if(initCallback&&(initCallbackTrigger&&initCallbackTrigger==='customer')){initCallback.call(window);}}}else{handleMessage(msg);}
if(callbackStack.length>0){for(var c=0;c<callbackStack.length;c++){callbackStack.splice(0,1)[0].call();}}});}
function onSocketOpen(){websocketSend({'type':'auth','api_key':_API_KEY,'customer':_CUSTOMER_ID});}
function onSocketClose(e){isValid=false;}
function onSocketMessage(e){try{var msg=JSON.parse(e.data.toString());}catch(err){console.info(e.data);return false;}
if(msg.length>0){for(var i=0;i<msg.length;i++){handleMessage(msg[i]);}}else{handleMessage(msg);}
if(callbackStack.length>0){for(var c=0;c<callbackStack.length;c++){callbackStack.splice(0,1)[0].call();}}}
function formatNumber(number){return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g,_L10N.groupSeparator||"");}
function handleMessage(msg){switch(msg.type){case'brand':handleBrandMessage(msg);break;case'activity':handleActivityMessage(msg);break;case'customer':handleCustomerMessage(msg);break;case'action':handleActionMessage(msg);break;case'hash':handleHashMessage(msg);break;case'debug':console.info(msg.data);break;case'error':console.error(msg.data.message);break;default:break;}}
function initExtensions(){for(var extension in extensions){if(extensions.hasOwnProperty(extension)){if(extension=='toast'){Antavo.PollToast.init();}else if(extension=='incentivizedpurchase'&&getExtensionInfo('campaigns')){Antavo.IncentivizedPurchase.init();}else if(extension=='campaigns'){Antavo.Campaigns.init();}else if(window===top&&"ziggy"===extension){(function(){var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.type='text/javascript';g.async=true;g.defer=true;g.src='//ziggy.antavo.com/ziggy.js';s.parentNode.insertBefore(g,s);g.onload=function(){var config=extensions["ziggy"];var data={"c":Antavo.SDK.getBrandId(),"auth":Antavo.SDK.getCustomer()?1:0};if(config.stardust&&"rise"===config.stardust&&Antavo.SDK.getCustomerId()){data["d"]=Antavo.SDK.getCustomerId();}
window.Ziggy.init(data);};})();}}}}
function handleBrandMessage(msg){var event;setBrand(msg.data,initExtensions);while(event=eventQueue.shift()){websocketSend(event);}
if(typeof Antavo.Widget!='undefined'&&msg.data.widget&&options.notifications){hasWidget=true;var opt_in_cookie=Antavo.Cookie.get(COOKIE_OPTIN);Antavo.Widget.setOptions(msg.data.widget);Antavo.Widget.positionWidget();Antavo.Widget.storeLotteryResult();if(opt_in_cookie&&opt_in_cookie==OPTIN_DONE){Antavo.Cookie.expire(COOKIE_OPTIN,opt_in_cookie,'/',getTopDomain());Antavo.Cookie.set(COOKIE_OPTIN,OPTIN_CONFIRMED,9999999999999999999999,'/',getTopDomain());Antavo.Widget.openSidebar();}}}
function handleCustomerMessage(msg){msg.data.promo_url=msg.url;_CUSTOMER=msg.data;auth(msg.data);if(typeof Antavo.Widget!='undefined'&&!Antavo.SDK.getExtensionInfo('contentconsumption')){Antavo.Widget.update(msg.data);}
if(typeof Antavo.Automation!='undefined'&&_CUSTOMER.status=='active'){Antavo.Automation.updatePoints(formatNumber(parseInt(msg.data.score)-parseInt(msg.data.spent)));}else{console.info('Got opted-out customer, no notifications or points.');}}
function handleActionMessage(msg){if(typeof Antavo.Automation!='undefined'&&typeof Antavo.Toast!='undefined'&&options.notifications&&_CUSTOMER.status=='active'){Antavo.Automation.updateLimitPoints(msg.data.points);Antavo.Event.trigger(document,events.SHOW_NOTIFICATION,msg);}}
function handleActivityMessage(msg){if(typeof Antavo.Toast!='undefined'&&options.notifications&&_CUSTOMER.status=='active'){Antavo.Event.trigger(document,events.SHOW_NOTIFICATION,msg);if(typeof MicrositeHelper!='undefined'){MicrositeHelper.flipCardBack(msg.data.activity);}}else{console.info('Got opted-out customer, no notifications or points.');}}
function handleHashMessage(msg){var data;if(msg.id&&msg.data){data=messageQueue[msg.id];data.hash=msg.data.hash;data.date=msg.data.date;Antavo.AJAX.post(endpoint,data,onAJAXSuccess,onAJAXError);delete messageQueue[msg.id];}}
function onSocketError(e){console.error(e);}
function send(action,data,customerId){if(_CUSTOMER_ID||customerId){Antavo.AJAX.post(endpoint,{'api_key':_API_KEY,'customer':customerId||_CUSTOMER_ID,'action':action,'data':data||{}},onAJAXSuccess,onAJAXError);}}
function sendVisit(url){var u=Antavo.URL(url);delete u.params["__al"];u.hash=null;send('visit',{url:u.toString()},_CUSTOMER_ID);if(typeof Antavo.Automation!=='undefined'){Antavo.Automation.setEventSent();}}
function onAJAXSuccess(response){if(response.id==_CUSTOMER_ID&&response.events instanceof Array){response.events.forEach(function(event){handleActionMessage({id:event.id,data:{points:event.points}});});}}
function onAJAXError(request,response){if(response.error){console.info('Got '+response.error.type+': '+response.error.message);}else{console.info(response);}}
function getCredentials(){return _API_KEY+' '+_CUSTOMER_ID;}
function getVisitor(){return Antavo.Cookie.get('_ga');}
function extractCustomerId(){var cookie=Antavo.Cookie.get(COOKIE_CUSTOMER);if(cookie){var enc=cookie.split('.')[1],dec=window.atob(enc);return JSON.parse(dec).customer;}
return null;}
function auth(data){var cookie,top_domain;if(getBrandId()){cookie=Antavo.Cookie.get(COOKIE_CUSTOMER);top_domain=getTopDomain();if(options.auth.method=='cookie'&&options.auth.cookie&&data.autologin_token){if(_CUSTOMER_ID){if(!cookie||data.autologin_token!=cookie){Antavo.Cookie.set(COOKIE_CUSTOMER,data.autologin_token,2700,'/',top_domain);}}else if(cookie){Antavo.Cookie.expire(COOKIE_CUSTOMER,cookie?cookie:'','/',top_domain);}}
if(options.auth.method=='social'&&data.autologin_token){if(_CUSTOMER_ID){if(!cookie||data.autologin_token!=cookie){Antavo.Cookie.set(COOKIE_CUSTOMER,data.autologin_token,7200,'/',top_domain);}}else if(cookie){Antavo.Cookie.expire(COOKIE_CUSTOMER,cookie?cookie:'','/',top_domain);}}
if(!Antavo.Automation.hasCustomerHash()){Antavo.Automation.setCustomerHash();}
if(initCallback&&(initCallbackTrigger&&initCallbackTrigger==='customer')){initCallback.call(window);}
Antavo.Event.trigger(document,events.SDK_AUTH_FINISHED,{});}else{setTimeout(function(){auth(data);},500);}}
function checkAuth(){if(options.auth.method=='social'&&!_CUSTOMER_ID&&socialHandshake==false){_CUSTOMER_ID=extractCustomerId();if(REST_AUTH){doApiAuth();}else{onSocketOpen();}
socialHandshake=true;}else if(!_CUSTOMER_ID&&socialHandshake==false){var cookie=Antavo.Cookie.get(COOKIE_CUSTOMER);Antavo.Cookie.expire(COOKIE_CUSTOMER,cookie?cookie:'','/',getTopDomain());}}
function setOptinCookie(href){var cookie=Antavo.Cookie.get(COOKIE_OPTIN);if(!cookie){Antavo.Cookie.set(COOKIE_OPTIN,OPTIN_PENDING,0,'/',getTopDomain());if(ga){ga('send','event','user-interactions','opt-in-initiated',getBrandId(),1);}
if(href){window.top.location.href=href;}
return true;}
if(href){window.top.location.href=href;}
return false;}
function getTopDomain(){return(location.hostname.indexOf('.co.uk')>-1||location.hostname.indexOf('.co.nl')>-1)?location.hostname.split('.').slice(-3).join('.'):location.hostname.split('.').slice(-2).join('.');}
function getFacebookAppId(){return _FACEBOOK_APP_ID;}
function isWidgetEnabled(){return hasWidget;}
function setBrand(data,callback){_FACEBOOK_APP_ID=data.facebook_app_id?data.facebook_app_id:'697644286957410';if(data.extensions.socialaccounts&&data.extensions.socialaccounts.facebook_api_key){_FACEBOOK_APP_ID=data.extensions.socialaccounts.facebook_api_key+"";}
_BRAND_ID=data.id;_BRAND_URL=data.urls.loyalty;_API_URL=data.urls.events;_CDN_URL=data.urls.cdn;_APPS_URL=data.apps_url;endpoint=data.urls.events;_REVIEWS_URL=data.urls.reviews;_LOGIN_URL=data.urls.login;_QUIZZES_URL=data.urls.quizzes;_L10N=data.l10n.messages;extensions=data.extensions;callbackStack.push(checkAuth);if(initCallback&&(initCallbackTrigger&&initCallbackTrigger==='brand')){initCallback.call(window);}
if(typeof callback==='function'){callback.call(window);}}
function getKey(key,fallback){if(_L10N){if(_L10N.hasOwnProperty(key)){return _L10N[key];}}
return fallback||false;}
function setKey(key,tense){_KEY_CHANGE[tense]=key;}
function getKeys(){return _KEY_CHANGE;}
function getOption(option){var optionPath=options;for(var i=0;i<arguments.length;i++){if(optionPath.hasOwnProperty(arguments[i])){optionPath=optionPath[arguments[i]];}else{return false;}}
return optionPath;}
function getExtensionInfo(extension){var extensionPath=extensions;for(var i=0;i<arguments.length;i++){if(extensionPath.hasOwnProperty(arguments[i])){extensionPath=extensionPath[arguments[i]];}else{return false;}}
return extensionPath;}
function getBrand(){return{id:_BRAND_ID,url:_BRAND_URL};}
function getBrandUrl(){return _BRAND_URL;}
function getBrandId(){return _BRAND_ID;}
function getCDNUrl(){return _CDN_URL;}
function getReviewsUrl(){return _REVIEWS_URL;}
function getLoginUrl(){return _LOGIN_URL;}
function getAppsUrl(){return _APPS_URL;}
function getCustomer(){return _CUSTOMER;}
function setCustomerProperty(prop,val){return _CUSTOMER[prop]=val;}
function injectStyleSheet(){if(getBrandId()){var s=document.createElement('link'),f=document.getElementsByTagName('link')[0];if(!document.getElementById('antavo_loyalty_helper_css')){s.setAttribute('href',getCDNUrl()+'/css/loyalty/helper.css');s.setAttribute('rel','stylesheet');s.setAttribute('type','text/css');s.setAttribute('id','antavo_loyalty_helper_css');if(typeof f!='undefined'&&f){f.parentNode.insertBefore(s,f);}else{document.querySelector('head').appendChild(s);}}}else{setTimeout(injectStyleSheet,500);}}
var SDK={getAPIKey:function(){return _API_KEY;},getAPIUrl:function(){return _API_URL;},getCustomerId:function(){return _CUSTOMER_ID;},getCustomerLevel:function(){return(_CUSTOMER)?_CUSTOMER['level']:null;},getEndpoint:function(){return endpoint;},getApiHost:function(){return apiHost;},getImageUrl:function(){return _CUSTOMER&&_CUSTOMER.image_url||getCDNUrl()+"/img/loyalty/anonymous.png";}};SDK.init=init;SDK.send=send;SDK.sendVisit=sendVisit;SDK.getCredentials=getCredentials;SDK.getBrand=getBrand;SDK.getBrandUrl=getBrandUrl;SDK.getBrandId=getBrandId;SDK.sendInitEvent=sendInitEvent;SDK.isReady=isReady;SDK.getKey=getKey;SDK.getKeys=getKeys;SDK.getCustomer=getCustomer;SDK.setCustomerProperty=setCustomerProperty;SDK.getCDNUrl=getCDNUrl;SDK.getFacebookAppId=getFacebookAppId;SDK.getAppsUrl=getAppsUrl;SDK.getReviewsUrl=getReviewsUrl;SDK.getLoginUrl=getLoginUrl;SDK.getOption=getOption;SDK.getTopDomain=getTopDomain;SDK.setOptinCookie=setOptinCookie;SDK.getVisitor=getVisitor;SDK.injectStyleSheet=injectStyleSheet;SDK.formatNumber=formatNumber;SDK.isWidgetEnabled=isWidgetEnabled;SDK.handleActionMessage=handleActionMessage;SDK.getExtensionInfo=getExtensionInfo;SDK.events=events;Antavo.SDK=SDK;}(document));var Antavo=window.Antavo||{};Antavo.Video=(function(parent){var playerList={},default_options={youtube_enabled:true,vimeo_enabled:true,show_banner:true,must_watch:50},banner=true,percent_to_watch=50,quiz=false,events={'VIDEO_END':'antavo_video_ended','VIDEO_WATCHED':'antavo_video_watched'},demo=false,isApps=false,brandID=(Antavo.SDK&&Antavo.SDK.getBrandId())?Antavo.SDK.getBrandId():false;function initYoutube(isEnabled){if(typeof window.onYouTubeIframeAPIReady==='undefined'&&isEnabled){var youtubeApiScript=document.createElement('script'),firstScript=document.getElementsByTagName('script')[0];youtubeApiScript.src="https://www.youtube.com/iframe_api";firstScript.parentNode.insertBefore(youtubeApiScript,firstScript);window.onYouTubeIframeAPIReady=function(){[].forEach.call(document.querySelectorAll('[src*="youtube.com"]:not(script),[src*="youtu.be"]:not(script)'),function(element){initYoutubeVideo(checkEnabledApi(element));});};}}
function initYoutubeVideo(YTVideoElement){var uniqueID=YTVideoElement.hasAttribute('id')?YTVideoElement.getAttribute('id'):generateVideoId();YTVideoElement.getAttribute('id')===uniqueID?'':YTVideoElement.setAttribute('id',uniqueID);playerList[uniqueID]={type:'youtube',total:0,played:0,counter:0,percent_to_watch:50,pointsValue:0,url:'',quizUrl:'',sent:false,playerObj:new YT.Player(uniqueID,{events:{'onReady':youTubeNoSeekCounter,'onStateChange':onPlayerStateChange}}),was_correct:false,available:null,watched:true};}
function youTubeNoSeekCounter(playerEvent){var currentVideo=playerList[playerEvent.target.getIframe().getAttribute('id')],lastTime=-1,interval=1000,checkPlayerTime=function(){if(lastTime!==-1){if(playerEvent.target.getPlayerState()===YT.PlayerState.PLAYING){var currentTime=playerEvent.target.getCurrentTime();if(Math.abs(currentTime-lastTime-1)>1){playerList[playerEvent.target.getIframe().getAttribute('id')].played--;}}}
lastTime=playerEvent.target.getCurrentTime();setTimeout(checkPlayerTime,interval);};setTimeout(checkPlayerTime,interval);currentVideo.total=playerEvent.target.getDuration();if(demo){}else if(typeof Antavo.SDK!=='undefined'){retrieveEventsInfo(playerEvent,playerList,playerEvent.target.getIframe().getAttribute('id'));}
window.addEventListener("scroll",function(e){hideBanner();});}
function onPlayerStateChange(playerEvent){if(YT.PlayerState.ENDED===playerEvent.data){var videoID=playerEvent.target.getIframe().getAttribute('id');if(!banner){Antavo.SDK.send('video',{type:'youtube',url:playerEvent.target.getVideoUrl(),id:playerEvent.target.getVideoData().video_id,title:playerEvent.target.getVideoData().title});clearAllIntervall();}else{clearAllIntervall();Antavo.Event.trigger(document,events.VIDEO_END,[]);}
if(quiz&&playerList[playerEvent.target.getIframe().getAttribute('id')].was_correct==null&&playerList[videoID].total-playerList[videoID].played<=3){if(Antavo.SDK.getExtensionInfo('contentconsumption')){openQuizPopup(playerList[videoID].quizUrl);}else{openQuizWidget(videoID,playerList[videoID].quizUrl);}}
clearAllIntervall();}else if(YT.PlayerState.PLAYING===playerEvent.data){var playing_video_id=playerEvent.target.getIframe().getAttribute('id'),startTimer=Date.now(),lastTime=-1;if(playerList[playing_video_id].url==='')playerList[playerEvent.target.getIframe().getAttribute('id')].url=playerEvent.target.getVideoUrl();playerList[playing_video_id].video_id=playerEvent.target.getVideoData().video_id;playerList[playing_video_id].counter=setInterval(function(){var tempTimer=Math.floor((Date.now()-startTimer)/ 1000);if(tempTimer-lastTime>=1){playerList[playing_video_id].played++;if(banner&&playerList[playing_video_id].pointsValue&&playerList[playing_video_id].pointsValue>0){updateRemainingBox((playerList[playing_video_id].total*(playerList[playing_video_id].percent_to_watch/100))-playerList[playing_video_id].played,playing_video_id);}}
lastTime=tempTimer;},250);}else if(YT.PlayerState.PAUSED===playerEvent.data){setTimeout(hideBanner,3000);clearInterval(playerList[playerEvent.target.getIframe().getAttribute('id')].counter);}}
function initVimeo(isEnabled){if(Antavo.SDK.getCDNUrl()){var vimeoAPIScript=document.createElement('script'),firstScript=document.getElementsByTagName('script')[0];if(isEnabled){vimeoAPIScript.src=Antavo.SDK.getCDNUrl()+"/lib/bower-froogaloop/froogaloop.min.js";firstScript.parentNode.insertBefore(vimeoAPIScript,firstScript);vimeoAPIScript.onload=function(){[].forEach.call(document.querySelectorAll('[src*="vimeo.com"]:not(script)'),function(element){initVimeoVideo(element);});};}}else{setTimeout(function(){initVimeo(isEnabled);},600);}}
function initVimeoVideo(vimeoVideoElement){var uniqueID=vimeoVideoElement.hasAttribute('id')?vimeoVideoElement.getAttribute('id'):generateVideoId(),newSrc=vimeoRegexp(vimeoVideoElement.src,0),newId=vimeoRegexp(vimeoVideoElement.src,3);vimeoVideoElement.setAttribute('src',vimeoSourceParser(vimeoVideoElement,uniqueID));vimeoVideoElement.hasAttribute('id')?'':vimeoVideoElement.setAttribute('id',uniqueID);playerList[uniqueID]={type:'vimeo',total:0,played:0,pointsValue:0,percent_to_watch:50,progress:[],url:'',quizUrl:'',src:newSrc,id:newId,watched:true,was_correct:null,available:null,playerObj:$f(vimeoVideoElement).addEvent('ready',function(e){$f(vimeoVideoElement).api('getVideoUrl',function(v){playerList[uniqueID].url=v;var currentVideo=playerList[uniqueID],vimeourl=playerList[uniqueID].url!==null?playerList[uniqueID].url:vimeoRegexp(vimeoVideoElement.src,0);if(typeof Antavo.SDK!=='undefined'){retrieveEventsInfo(vimeoVideoElement,playerList,uniqueID);}});if(playerList[uniqueID].url.length<=0){var newUrl=new Antavo.URL(vimeoVideoElement.src);var newSrc=newUrl.protocol+'://'+newUrl.host+newUrl.path;playerList[uniqueID].url=newSrc;if(typeof Antavo.SDK!=='undefined'){retrieveEventsInfo(vimeoVideoElement,playerList,uniqueID);}}
window.addEventListener("scroll",function(e){hideBanner();});$f(vimeoVideoElement).addEvent('playProgress',function(e){vimeoNoSeekCounter(e,uniqueID);$f(vimeoVideoElement).api('getVideoUrl',function(v){playerList[uniqueID].url=v;});});$f(vimeoVideoElement).addEvent('pause',function(e){setTimeout(hideBanner,3000);});$f(vimeoVideoElement).addEvent('finish',function(e){if(!banner){Antavo.SDK.send('video',{type:'vimeo',url:playerList[uniqueID].url});}else{Antavo.Event.trigger(document,events.VIDEO_END,[]);}
if(quiz&&playerList[uniqueID].was_correct==null&&playerList[uniqueID].played>9){if(Antavo.SDK.getExtensionInfo('contentconsumption')){openQuizPopup(playerList[uniqueID].quizUrl);}else{openQuizWidget(uniqueID,playerList[uniqueID].quizUrl);}}});})};}
function vimeoNoSeekCounter(playerEvent,uniqueID){var currentPercent=playerEvent.percent*1000,total=playerList[uniqueID].total;if(playerList[uniqueID].progress){if(total<100){total+=200;}
if(playerList[uniqueID].progress.indexOf(currentPercent)!==-1){return;}
playerList[uniqueID].total=playerEvent.duration;playerList[uniqueID].progress.push(currentPercent);playerList[uniqueID].played=parseInt((total / 1000)*playerList[uniqueID].progress.length);if(banner&&playerList[uniqueID].pointsValue&&playerList[uniqueID].pointsValue>0){updateRemainingBox((playerList[uniqueID].total*(playerList[uniqueID].percent_to_watch/100))-playerList[uniqueID].played,uniqueID);}}else{playerList[uniqueID].progress=[];playerList[uniqueID].total=playerEvent.duration;playerList[uniqueID].played=0;}}
function addVideoFrame(provider,id){var properWindow=window.parent.document.getElementById('tpl-video-frame')?window.parent:window,tpl=properWindow.document.getElementById('tpl-video-frame'),template=(isIE())?new Antavo.Template(tpl.cloneNode(true)):new Antavo.Template(tpl.content.cloneNode(true)),wrapper=getVideoFrameWrapper(),d=new Date(),h=d.getTime(),fs={};fs.content=provider==='vimeo'?'<iframe id="apf'+h+'" src="https://player.vimeo.com/video/'+id+'?api=1&title=0&autoplay=1&player_id=apf'+h+'" width="500" height="209" frameborder="0" autoplay="1" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>':'<iframe id="apf'+h+'" width="560" height="315" src="https://www.youtube.com/embed/'+id+'?enablejsapi=1&autoplay=1&autohide=1" frameborder="0" allowfullscreen></iframe>';if(typeof Antavo.SDK!=='undefined'){Antavo.SDK.injectStyleSheet();}
wrapper.innerHTML=template.replace(fs);if(provider==='vimeo'){initVimeoVideo(wrapper.querySelector('#apf'+h));}else{initYoutubeVideo(wrapper.querySelector('#apf'+h));}}
function updateRemainingBox(remaining,id){var properWindow=demo?self:window.parent,r=new RegExp("(video-[\w]*)","g"),remainingBox=properWindow.document.querySelector('.antavo-remaining-box'),hour='',min='',second='',container=properWindow.document.getElementById('antavo-loyalty-video-dialog'),customer=typeof Antavo.SDK!=='undefined'?Antavo.SDK.getCustomer():demo,videoWrapper=properWindow.document.querySelector('iframe[id="'+id+'"]'),isQuiz=(quiz&&playerList[id].quizUrl!=null);if(isApps){remainingBox.classList.add('loyalty-apps');}else{remainingBox.classList.remove('loyalty-apps');}
remainingBox.className.replace(r,'');remainingBox.classList.add('video-'+id);if(typeof customer!='undefined'&&(playerList[id].watched||customer.limit)&&!demo){var remainingContent="";if(typeof remainingBox=='undefined'||remainingBox===null){remainingBox=setCounterBoxTemplate();alignCounterBox(videoWrapper);}else{alignCounterBox(videoWrapper);}
if(customer&&customer.limit){remainingContent=typeof Antavo.SDK!=='undefined'&&Antavo.SDK.getKey('lm_reached_limit')?Antavo.SDK.getKey('lm_reached_limit'):'You had reached the daily limit!';}else{remainingContent=typeof Antavo.SDK!=='undefined'&&Antavo.SDK.getKey('lm_video_already_watched')?Antavo.SDK.getKey('lm_video_already_watched'):'You already got points for this video!';}
setRemainingBoxTemplate('antavo-successful');setCounterBoxContent('.success-wrapper','<p>'+remainingContent+'</p>');}else if(!remainingBox&&!container&&remaining>0){remainingBox=setCounterBoxTemplate();alignCounterBox(videoWrapper);}else if(remainingBox&&isQuiz&&playerList[id].was_correct==true){var success=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_video_already_watched')?Antavo.SDK.getKey('lm_video_already_watched'):'You already got points for this video!';alignCounterBox(videoWrapper);setRemainingBoxTemplate('antavo-successful');setCounterBoxContent('.success-wrapper','<div class="success-wrapper"><p>'+success+'</p></div>');}else if(remainingBox&&isQuiz&&playerList[id].was_correct==false&&playerList[id].available!=null){var now=parseInt((new Date()).getTime()/ 1000);remaining=Math.ceil((new Date(playerList[id].available).getTime()-now));if(remaining>0){hour=parseInt(remaining/3600)<=0?'':parseInt(remaining/3600)+':';min=!parseInt(remaining/3600)<=0&&parseInt(remaining/60)%60<=9?'0'+parseInt(remaining/60)%60:parseInt(remaining/60)%60;second=parseInt(remaining%60)<=9?'0'+parseInt(remaining%60):parseInt(remaining%60);alignCounterBox(videoWrapper);setCounterBoxContent(generateNewCounterTime(hour,min,second,id));}else{var success=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_video_take_quiz_now')?Antavo.SDK.getKey('lm_watch_video_now'):'You can take our quiz about this video <button data-open-widget href="%s">now</button>',button,aSDK=demo||Antavo.SDK.getCustomer(),img_url=demo?demo.image_url:Antavo.SDK.getImageUrl(),image_src=document.querySelector('#antavo-remaining-box-image'),handler=demo?demo.first_name:aSDK.handler;alignCounterBox(videoWrapper);setRemainingBoxTemplate('loggedin');if(success.match('%s')){setCounterBoxContent('#remaining-time','<p>'+success.replace(/(%s)/gmi,playerList[id].quizUrl)+'</p>');}else{setCounterBoxContent('#remaining-time','<p>'+success+'</p>');}
setCounterBoxContent('#antavo-remaining-box-name',handler);setCounterBoxContent('#antavo-remaining-box-point-value',playerList[id].pointsValue);image_src?image_src.setAttribute('src',img_url):'';button=document.querySelector('.antavo-remaining-box p button[data-open-widget]');if(button){button.addEventListener('click',function(e){e.preventDefault();Antavo.Widget.openSidebar(button.getAttribute('href'));});}}}else if(remainingBox&&isQuiz&&playerList[id].watched){var success=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_video_take_quiz_now')?Antavo.SDK.getKey('lm_watch_video_now'):'You can take our quiz about this video <button data-open-widget href="%s">now</button>',button,aSDK=demo||Antavo.SDK.getCustomer(),img_url=demo?demo.image_url:Antavo.SDK.getImageUrl(),image_src=document.querySelector('#antavo-remaining-box-image');alignCounterBox(videoWrapper);setRemainingBoxTemplate('loggedin');if(success.match('%s')){setCounterBoxContent('#remaining-time','<p>'+success.replace(/(%s)/gmi,playerList[id].quizUrl)+'</p>');}else{setCounterBoxContent('#remaining-time','<p>'+success+'</p>');}
setCounterBoxContent('#antavo-remaining-box-name',aSDK.handler);setCounterBoxContent('#antavo-remaining-box-point-value',playerList[id].pointsValue);image_src?image_src.setAttribute('src',img_url):'';button=document.querySelector('.antavo-remaining-box p button[data-open-widget]');if(button){button.addEventListener('click',function(e){e.preventDefault();Antavo.Widget.openSidebar(button.getAttribute('href'));});}}else if(remaining>1){hour=parseInt(remaining/3600)<=0?'':parseInt(remaining/3600)+':';min=parseInt(remaining/60);second=parseInt(remaining%60)<=9?'0'+parseInt(remaining%60):parseInt(remaining%60);alignCounterBox(videoWrapper);setCounterBoxContent(generateNewCounterTime(hour,min,second,id));}else if(remainingBox){if((typeof Antavo.SDK!='undefined'&&typeof Antavo.SDK.getCustomer()!='undefined'&&Antavo.SDK.getBrandId())||demo){var success=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_finished_video_label')?Antavo.SDK.getKey('lm_finished_video_label'):'Congratulations!',remainingBox=document.querySelector('.antavo-remaining-box');if(window.getComputedStyle.display!='none'&&typeof remainingBox!='undefined'&&remainingBox.style.display!='none'){alignCounterBox(videoWrapper);setRemainingBoxTemplate('antavo-successful');setCounterBoxContent('.success-wrapper','<div class="success-wrapper"><p>'+success+'</p></div>');}
sendWatchedVideo(id);setTimeout(hideBanner,5000);}else{setTimeout(hideBanner,0);}}}
function sortingVideo(data,provider){return(provider==='vimeo')?data.match(/https?:\/\/(?:www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|)(\d+)(?:$|\/|\?)/):data.match(/^(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/watch\?.+&v=))([\w-]{11})(?:.+)?$/);}
function openVideo(videoUrl){if(videoUrl&&videoUrl!=undefined){var p=videoUrl.indexOf('vimeo')>-1?'vimeo':'youtube',vid=sortingVideo(videoUrl,p);if(vid&&vid.length>0){vid=vid[vid.length-1];addVideoFrame(p,vid);}else{console.error('No video ID found or malformed video URL.');}}}
function initializing(options,fake_customer){var eventMethod=window.addEventListener?"addEventListener":"attachEvent";var eventer=window[eventMethod];var messageEvent=eventMethod=="attachEvent"?"onmessage":"message";demo=fake_customer?fake_customer:false;options=options?options:default_options;banner=options.show_banner;percent_to_watch=options.must_watch;hideBanner();initYoutube(options.youtube_enabled);initVimeo(options.vimeo_enabled);document.addEventListener('click',function(e){var wv;if(e.target.getAttribute('id')==='antavo-loyalty-video-dialog-wrapper'){closeVideoFrame();}
if(Antavo.DOM.closest(e.target,'[data-close-video-dialog]')){closeVideoFrame();}
if(wv=Antavo.DOM.closest(e.target,'[data-watch-video]')){e.preventDefault();openVideo(wv.getAttribute('data-watch-video'));}});document.addEventListener('keyup',function(e){if(e.which==null&&(e.charCode!=null||e.keyCode!=null)){e.which=e.charCode!=null?e.charCode:e.keyCode;}
if(e.which==='27')closeVideoFrame();});eventer(messageEvent,function(e){var key=e.message?"message":"data";var data=e[key];if(e.data[0]&&e.data[0]==='addVideoFrame'&&e.data[1]){var p=e.data[1].indexOf('vimeo')>-1?'vimeo':'youtube',vid=sortingVideo(e.data[1],p);if(vid&&vid.length>0){vid=vid[vid.length-1];addVideoFrame(p,vid);}else{console.error('No video ID found or malformed video URL.');}}},false);getIfAppsEnv();}
function checkEnabledApi(element){var regexp=/enablejsapi=1/;var url=element.getAttribute('src');if(!regexp.test(element.src)){element.setAttribute('src',url+(url.indexOf('?')==-1?'?':'&')+'enablejsapi=1');}
return element;}
function getIfAppsEnv(){if(Antavo&&Antavo.SDK.getExtensionInfo()!=undefined){isApps=Antavo.SDK.getExtensionInfo('contentconsumption')||false;}else{window.setTimeout(getIfAppsEnv,1000);}}
function generateVideoId(){var text="",possible="0123456789",i;for(i=0;i<13;i++){text+=possible.charAt(Math.floor(Math.random()*possible.length));}
return'apf'+text;}
function generateNewCounterTime(hour,minute,second,id){if((typeof Antavo.SDK!='undefined'&&typeof Antavo.SDK.getCustomer()!='undefined'&&Antavo.SDK.getBrandId())||demo){var aSDK=demo||Antavo.SDK.getCustomer(),img_url=demo?demo.image_url:Antavo.SDK.getImageUrl(),counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_get_points_in_minutes_label')?Antavo.SDK.getKey('lm_get_points_in_minutes_label'):'You will get your points in %s',pointText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_spendable_points_label')?Antavo.SDK.getKey('lm_spendable_points_label'):'points',image_src=document.querySelector('#antavo-remaining-box-image'),counter='<strong>'+hour+minute+':'+second+' </strong>',handler=demo?demo.first_name:aSDK.handler,greeting=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lc_customer_greeting')?formatKey(Antavo.SDK.getKey('lc_customer_greeting'),[handler]):formatKey('Hi %s!',[handler]);if(quiz&&playerList[id].quizUrl!=null){if(playerList[id].was_correct==null){counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_get_points_to_quiz_label')?Antavo.SDK.getKey('lm_get_points_to_quiz_label'):'You can take a quiz about this video in %s';}else if(playerList[id].was_correct==false&&playerList[id].available!=null){counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_try_again_our_quiz')?Antavo.SDK.getKey('lm_try_again_our_quiz'):'You can take our quiz again in %s';}else if(playerList[id].was_correct==false&&playerList[id].available<0){counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_take_quiz_now')?Antavo.SDK.getKey('lm_take_quiz_now'):'You can take our quiz about this video now ';}else{counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_get_points_to_quiz_label')?Antavo.SDK.getKey('lm_get_points_to_quiz_label'):'You can take a quiz about this video in %s';}}
setRemainingBoxTemplate('loggedin');if(image_src)image_src.setAttribute('src',img_url);setCounterBoxContent('#antavo-remaining-box-name',handler);if(counterText.match('%s')){if(isApps){setCounterBoxContent('#remaining-time',greeting+'&nbsp;'+counterText.replace(/(%s)/gmi,counter));}else{setCounterBoxContent('#remaining-time',counterText.replace(/(%s)/gmi,counter));}}else{if(isApps){setCounterBoxContent('#remaining-time',greeting+'&nbsp;'+counterText+counter);}else{setCounterBoxContent('#remaining-time',counterText+counter);}}
if(!playerList[id].watched||demo){setCounterBoxContent('#antavo-remaining-box-point-value',demo?'150':playerList[id].pointsValue);setCounterBoxContent('#antavo-remaining-box-point-label',pointText);}}else{var counterText=(typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_would_get_points'))?Antavo.SDK.getKey('lm_would_get_points'):'%s and you would get your points',pointText=(typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_spendable_points_label'))?Antavo.SDK.getKey('lm_spendable_points_label'):'points',signInText=(typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_sign_in_label'))?Antavo.SDK.getKey('lm_sign_in_label'):'Sign in',loginLink=document.querySelector('#antavo-remaining-box-login-url'),counter='<strong>'+hour+minute+':'+second+' </strong>';if(quiz&&playerList[id].quizUrl!=null){counterText=typeof Antavo.SDK!='undefined'&&Antavo.SDK.getKey('lm_get_points_to_quiz_label')?Antavo.SDK.getKey('lm_get_points_to_quiz_label'):'and you can take our quiz';}
setRemainingBoxTemplate('guest');setCounterBoxContent('#antavo-remaining-box-point-value2',playerList[id].pointsValue);setCounterBoxContent('#antavo-remaining-box-point-label2',pointText);if(counterText.match('%s')){setCounterBoxContent('#remaining-time2',counterText.replace(/(%s)/gmi,counter));}else{setCounterBoxContent('#remaining-time2',counterText+counter);}
setCounterBoxContent('#antavo-remaining-box-login-link',signInText);if(!playerList[id].watched){setCounterBoxContent('#antavo-remaining-box-point-value',playerList[id].pointsValue);setCounterBoxContent('#antavo-remaining-box-point-label',pointText);}
if(loginLink){loginLink.setAttribute('href',parseLoginUrl());}}}
function vimeoRegexp(src,number){var regexp=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:|$|\/|\?)/;return src.match(regexp)[number];}
function vimeoSourceParser(vimeoElement,uniqueID){var regexp_api=/api=1/,regexp_id=/player_id=/,api=(!regexp_api.test(vimeoElement.src))?'?api=1':'',player=(!regexp_id.test(vimeoElement.src))?'&player_id='+uniqueID:'';return vimeoElement.getAttribute('src')+api+player;}
function retrieveEventsInfo(playerEvent,playerList,id){var responseObject={};Antavo.AJAX.get(prepareEndPointURL((typeof playerEvent.target=='undefined')?vimeoRegexp(playerList[id].src,0):playerEvent.target.getVideoUrl()),function(response){responseObject.watched=response.done;if(response.limit){Antavo.SDK.setCustomerProperty('limit',response.limit);}
if(typeof response.quiz!='undefined'&&response.quiz!==null&&response.quiz.url!=null&&response.quiz.url!=''){quiz=true;playerList[id].percent_to_watch=98;playerList[id].quizUrl=response.quiz.url;typeof response.quiz.points!='undefined'?playerList[id].pointsValue=response.quiz.points:'';}else{quiz=false;playerList[id].percent_to_watch=50;if(response.points){playerList[id].pointsValue=response.points;}}
if(playerList&&id){playerList[id].watched=response.done;if(quiz&&typeof response.quiz.is_correct!='undefined'){playerList[id].was_correct=response.quiz.is_correct;playerList[id].available=response.quiz.answer_in||null;}}
return responseObject;},function(context,request,response){});}
function prepareEndPointURL(videoURL){var url=Antavo.SDK.getEndpoint();if(Antavo.SDK.getCustomerId()){url+="/"+Antavo.SDK.getCustomerId();}
return url+"/video/"+encodeURIComponent(videoURL)
+"?api_key="+Antavo.SDK.getAPIKey();}
function clearAllIntervall(){for(x in playerList){clearInterval(playerList[x].counter);}}
function hideBanner(closeFrame){var remainingBox=document.querySelector('.antavo-remaining-box'),content=window.parent.document.getElementById('antavo-loyalty-video-dialog'),closeFrame=(typeof closeFrame!='undefined')?closeFrame:false;if(closeFrame==true){clearAllIntervall();}
if(content&&closeFrame){remainingBox.setAttribute('style','display: none;');}else if(content){}else if(remainingBox!==null){remainingBox.setAttribute('style','display: none;');}}
function parseLoginUrl(){if(!demo){var login_url=Antavo.SDK.getLoginUrl(),encLocation=encodeURIComponent(window.location.href);if(login_url){if(login_url.match('%s')){return login_url.replace('%s',encLocation);}
return login_url;}
return Antavo.SDK.getBrandUrl();}
return'#';}
function sendWatchedVideo(uniqueID){if(!demo){if(playerList[uniqueID].type==='youtube'){Antavo.SDK.send('video',{type:'youtube',url:playerList[uniqueID].url,id:playerList[uniqueID].video_id});}else if(playerList[uniqueID].type==='vimeo'){if(playerList[uniqueID].url!==null){Antavo.SDK.send('video',{type:'vimeo',url:playerList[uniqueID].url,id:playerList[uniqueID].id});}else{Antavo.SDK.send('video',{type:'vimeo',url:playerList[uniqueID].src,id:playerList[uniqueID].id});}}
if(typeof playerList[uniqueID].quizUrl!='undefined'&&playerList[uniqueID].quizUrl!=null){openQuizWidget(uniqueID,playerList[uniqueID].quizUrl);}}else{Antavo.Event.trigger(document,events.VIDEO_WATCHED,[]);}
playerList[uniqueID].type='sent';}
function alignCounterBox(clientRect){var properWindow=demo?self:window.parent,counterBox=properWindow.document.querySelector('.antavo-remaining-box'),container=isIE()?properWindow.document.getElementById('antavo-loyalty-video-dialog-wrapper').firstElementChild:properWindow.document.getElementById('antavo-loyalty-video-dialog'),rect=clientRect?clientRect.getBoundingClientRect():false;if(counterBox&&rect){if(container){counterBox.setAttribute('style',"position:fixed;z-index:2147483647;left:"+rect.left+"px;top:"+rect.bottom+"px;");counterBox.style.width='calc('+container.clientWidth+'px - 2rem)';}else{counterBox.setAttribute('style',"position:fixed;left:"+rect.left+"px;top:"+rect.bottom+"px;");counterBox.style.width=clientRect.offsetWidth+'px';}}}
function setCounterBoxContent(element,content){var properWindow=window.parent.document.getElementById('tpl-video-frame')?window.parent:window,counterBox=properWindow.document.querySelector('.antavo-remaining-box'),changeMyInner;if(counterBox){changeMyInner=counterBox.querySelector(element);if(brandID){counterBox.classList.add('brand-'+brandID);}else{brandID=(Antavo.SDK&&Antavo.SDK.getBrandId())?Antavo.SDK.getBrandId():false;}
if(changeMyInner){changeMyInner.innerHTML=content;}}}
function setRemainingBoxTemplate(state){var properWindow=window.parent.document.getElementById('tpl-video-frame')?window.parent:window,counterBox=properWindow.document.querySelector('.antavo-remaining-box'),mainBlocks;if(counterBox){mainBlocks=counterBox.querySelectorAll('.antavo-remaining-box-main-block');counterBox.classList.remove('antavo-hidden');if(mainBlocks){for(var i=0;i<mainBlocks.length;i++){mainBlocks[i].classList.add('antavo-hidden');}}
counterBox.querySelector('.'+state).classList.remove('antavo-hidden');}}
function setCounterBoxTemplate(){var properWindow=window.parent.document.getElementById('tpl-video-frame')?window.parent:window,tpl=properWindow.document.getElementById('tpl-antavo-remaining-box'),template;if(tpl){template=new Antavo.Template(tpl.content.cloneNode(true));}}
function injectTemplate(template){return document.getElementsByTagName('body')[0].appendChild(Antavo.DOM.fromString(template));}
function getVideoFrameWrapper(){var videoWrapper,documentElement=window.parent.document.getElementById('tpl-video-frame')?window.parent.document:document;if(videoWrapper=documentElement.getElementById('antavo-loyalty-video-dialog-wrapper')){return videoWrapper;}else{videoWrapper=documentElement.createElement('div');videoWrapper.setAttribute('id','antavo-loyalty-video-dialog-wrapper');if(demo){videoWrapper.setAttribute('class','demo-frame');}
return documentElement.body.appendChild(videoWrapper);}}
function formatKey(message,keys){var result=message;for(var x=0;x<keys.length;x++){result=result.replace('%s',keys[x]);}
return result;}
function openQuizPopup(url){if(url){Antavo.Popup.display(url);}}
function openQuizWidget(id,url){if(quiz&&typeof playerList[id].was_correct!='undefined'&&typeof url!='undefined'&&!isApps){Antavo.Widget.openSidebar(url);}}
function closeVideoFrame(){hideBanner(true);return getVideoFrameWrapper().parentNode.removeChild(getVideoFrameWrapper());}
function isIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||navigator.userAgent.match(/Edge\/12./i)){return true;}else{return false;}}
function getPlayerList(){return playerList;}
return{init:initializing,getPlayerList:getPlayerList,addVideoFrame:addVideoFrame,openVideo:openVideo,closeVideoFrame:closeVideoFrame,injectTemplate:injectTemplate}})(Antavo);var Antavo=window.Antavo||{};Antavo.Social=(function(parent){var default_options={facebook:{enabled:true},twitter:{enabled:true},google:{enabled:true}},widgetAttribute='data-as-widgets',widgetSelector='['+widgetAttribute+']',widgetLayoutAttribute='data-as-layout',widgetLayoutSelector='['+widgetLayoutAttribute+']',widgetSizeAttribute='data-as-size',widgetSizeSelector='['+widgetSizeAttribute+']',widgetParamsAttribute='data-as-params',widgetParamsSelector='['+widgetParamsAttribute+']',widgets,widgetCount=0,widgetTypes=['google-share','facebook-share','twitter-tweet','twitter-follow','youtube-subscribe'],widgetLayouts=['inline','inline-circles','block'],widgetSizes=['mini','midi','mega'],fbShareAttribute='data-facebook-share',fbShareSelector='['+fbShareAttribute+']',twtrTweetAttribute='data-twitter-tweet',twtrTweetSelector='['+twtrTweetAttribute+']',twtrFollowAttribute='data-twitter-follow',twtrFollowSelector='['+twtrFollowAttribute+']',gShareAttribute='data-google-plus-share',gShareSelector='['+gShareAttribute+']',gFollowAttribute='data-google-plus-follow',gFollowSelector='['+gShareAttribute+']',shareCounts={};"antavo_sdk_customer_authenticated antavo_sdk_customer_not_authenticated".split(" ").forEach(function(event){document.addEventListener(event,init);});function init(){if(Antavo.SDK.getOption('social')&&(Antavo.SDK.getAPIKey()=="ANYHRA4VTAAABTVOERD"||Antavo.SDK.getOption('social').enabled)){var options=default_options;if(options.facebook.enabled)initFB();if(options.twitter.enabled&&Antavo.SDK.getAPIKey()!="ANYHRA4VTAAABTVOERD")initTwitter();if(options.google.enabled)initGoogle();parseWidgets();}}
function initTwitter(){if(typeof window.twttr=='undefined'){window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));twttr.ready(function(twttr){document.addEventListener(Antavo.Automation.events.TRACKING_CHANGED,updateTwitterButtons);twttr.events.bind('tweet',function(event){event.url=event.target.getAttribute(twtrTweetAttribute);sendSocialEvent('twitter','tweet',event);});twttr.events.bind('follow',function(event){event.url=event.target.getAttribute(twtrFollowAttribute);sendSocialEvent('twitter','follow',event);});});}}
function initGoogle(){var s=document.createElement('script'),f=document.getElementsByTagName('script')[0];s.setAttribute('src','https://apis.google.com/js/platform.js');f.parentNode.insertBefore(s,f);window.onYoutubeEvent=function(payload){if(payload.eventType=='subscribe'){}else if(payload.eventType=='unsubscribe'){}}}
function initFB(){if(typeof FB=='undefined'){window.fbAsyncInit=function(){FB.init({appId:Antavo.SDK.getFacebookAppId(),xfbml:true,cookie:true,status:true,oauth:true,version:'v2.3'});FB.Event.subscribe('edge.create',function(response){sendSocialEvent('facebook','like',response);});initFBListeners();};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}
js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));}else{initFBListeners();}}
function initFBListeners(){Antavo.Event.bind('click',fbShareSelector,function(e){window.fbShareUrlBuffer=closest(e.target,fbShareSelector).getAttribute(fbShareAttribute);FB.ui({method:'feed',display:'dialog',link:closest(e.target,fbShareSelector).getAttribute(fbShareAttribute)},function(response){if(response&&response.post_id){response.url=window.fbShareUrlBuffer;sendSocialEvent('facebook','share',response);}});})
document.addEventListener(Antavo.Automation.events.TRACKING_CHANGED,updateFacebookButtons);}
function sendSocialEvent(channel,action,data){Antavo.SDK.send('social_share',{'url':data.url});}
function parseWidgets(){if(1==1){widgets=document.querySelectorAll(widgetSelector);for(var i=0;i<widgets.length;i++){var widget=widgets[i],actions=widget.getAttribute(widgetAttribute),params=widget.getAttribute(widgetParamsAttribute),size=widget.hasAttribute(widgetSizeAttribute)?widget.getAttribute(widgetSizeAttribute):'midi',layout=widget.hasAttribute(widgetLayoutAttribute)?widget.getAttribute(widgetLayoutAttribute):'inline';if(!actions||actions==''){console.info('Found a social widget without any action. Skipping...');}else{var actionsList=actions.split(','),paramList=params?params.split(','):[];if(actionsList.length!=paramList.length){console.error('One or more social widget parameters are missing.\n Please provide parameters for every social action you\'ve specified in the widget or use `location` where you want to use the current url (please note that this method won\'t work for follow and subscribe actions)!');}else{for(var a=0;a<actionsList.length;a++){var action=actionsList[a],param=paramList[a]!='location'?paramList[a].trim():location.href,url,elem=action=='facebook-like'?createLikeButton():document.createElement('A');if(action!='facebook-like'){elem.setAttribute('data-'+action,param);if(contains(['twitter-follow','twitter-tweet'],action)){url=action=='twitter-follow'?'https://twitter.com/intent/follow/?screen_name=':'https://twitter.com/intent/tweet/?text=';elem.setAttribute(action=='twitter-follow'?twtrFollowAttribute:twtrTweetAttribute,param);elem.setAttribute('href',url+encodeURIComponent(param));}
elem.innerText=action;}
widget.appendChild(elem);widgetCount++;}}}}
if(widgetCount>0)Antavo.SDK.injectStyleSheet();}else{setTimeout(function(){parseWidgets()},500);}}
function createLikeButton(){var btn=document.createElement('DIV');btn.className='fb-like';btn.setAttribute('data-layout','button');btn.setAttribute('data-action','like');btn.setAttribute('data-show-faces','false');btn.setAttribute('data-share','false');return btn;}
function contains(a,obj){for(var i=0;i<a.length;i++){if(a[i]===obj){return true;}}
return false;}
function updateTwitterButtons(){var twttr_buttons=document.querySelectorAll('[id*="twitter-widget-"]');for(var i=0;i<twttr_buttons.length;i++){var href=new Antavo.URL(twttr_buttons[i].getAttribute('src')),params=href.parseQuery(href.hash),bi=new Antavo.URL('https://twitter.com/intent/tweet'),nb=document.createElement('A');bi.params['url']=window.location.toString();if(params['via'])bi.params['via']=params['via'];if(params['text'])bi.params['text']=params['text'];nb.setAttribute('href',bi.toString());nb.classList.add('twitter-share-button');twttr_buttons[i].parentNode.insertBefore(nb,twttr_buttons[i]);twttr_buttons[i].parentNode.removeChild(twttr_buttons[i]);twttr.widgets.load();}}
function updateFacebookButtons(){var fb_buttons=document.querySelectorAll('.fb-share-button, .fb-like');for(var i=0;i<fb_buttons.length;i++){var href=fb_buttons[i].getAttribute('data-href'),layout=fb_buttons[i].getAttribute('data-layout'),nb=document.createElement('DIV');nb.className=fb_buttons[i].classList.contains('fb-share-button')?'fb-share-button':'fb-like';nb.setAttribute('data-href',window.location.href);if(layout.indexOf('button')>-1){nb.setAttribute('data-layout','button');}else{nb.setAttribute('data-layout','box');}
if(fb_buttons[i].hasAttribute('data-action')){nb.setAttribute('data-action',fb_buttons[i].getAttribute('data-action'));}
if(fb_buttons[i].hasAttribute('data-show-faces')){nb.setAttribute('data-show-faces',fb_buttons[i].getAttribute('data-show-faces'));}
if(fb_buttons[i].hasAttribute('data-share')){nb.setAttribute('data-share',fb_buttons[i].getAttribute('data-share'));}
fb_buttons[i].parentNode.insertBefore(nb,fb_buttons[i]);fb_buttons[i].parentNode.removeChild(fb_buttons[i]);}
FB.XFBML.parse();}
function countShares(new_url,url,element){shareCounts[url]={url:url,tracking_url:new_url,count:0};Antavo.AJAX.get('//api.facebook.com/restserver.php?method=links.getStats&format=json&urls='+url,function(response,element){shareCounts[response[0].url]['count']=response[0].total_count;updateShareCounts(shareCounts[response[0].url]['tracking_url'],response[0].total_count);},function(response){},document,true);}
function getShareCounts(){return shareCounts;}
function updateShareCounts(url,count){var buttons=document.querySelectorAll('[data-href="'+url+'"]'),counter=document.createElement('DIV');if(parseFloat(count / 1000000)>1){count=parseFloat(count / 1000000).toFixed(1)+'m';}else if(parseFloat(count / 1000)>1){count=parseFloat(count / 1000).toFixed(1)+'k';}
counter.innerHTML=count;counter.className='antavo-updated-share-count';for(var i=0;i<buttons.length;i++){buttons[i].parentNode.insertBefore(counter,buttons[i].nextSibling);}}
return{init:init,getShareCounts:getShareCounts}})(Antavo);var Antavo=window.Antavo||{};(function(document){'use strict';var mobile=Antavo.isMobile().any();var share_object={};var talker;var popup_visible=true;var extension_info,extension_option;function toggleClass(element,class_name){if(element&&element.classList.contains(class_name)){element.classList.remove(class_name);}else if(element){element.classList.add(class_name);}}
function setAlignment(){var mainBlock=document.querySelector('.la-social-share-block');if(mobile&&mainBlock){mainBlock.classList.add('mobile');if(extension_info.mobile_position){switch(extension_info.mobile_position){case'top-right':mainBlock.classList.add('top');mainBlock.classList.add('right');break;case'top-left':break;case'bottom-right':mainBlock.classList.add('bottom');mainBlock.classList.add('right');break;case'bottom-left':mainBlock.classList.add('bottom');mainBlock.classList.add('left');break;default:break;}}}else{if(extension_info.desktop_position&&extension_info.desktop_position=='right'&&mainBlock){mainBlock.classList.add('right-attached');}}}
function storePreLoginState(url,channel){if(typeof url!='undefined'&&Antavo.SDK.getCustomerId()==""){if(channel=='facebook'){channel=1;}else if(channel=='twitter'){channel=2;}else{channel=3;}
Antavo.Cookie.set('__alru',url+'#la_popup='+channel,360);}}
function checkForJoin(){if(Antavo.SDK.getCustomer()){var c=Antavo.Cookie.get('__alru');if(c&&c.length>5){Antavo.Cookie.set('__alru','',1);window.top.location=c;}}}
function initEventListeners(){var mobileButton=document.querySelector('[data-mobile-share-button]'),list=document.querySelector('.la-social-share-list'),popupClose=document.querySelector('[data-close-share-section]');if(mobile&&mobileButton){mobileButton.addEventListener('click',function(e){toggleClass(list,'expanded');toggleClass(mobileButton,'text');list.classList.remove('fade');});}
if(popupClose){popupClose.addEventListener('click',function(event){closePopup();});}
document.addEventListener('click',function(e){var current=Antavo.DOM.closest(e.target,'[data-antavo-share]');if(current){e.preventDefault();if(mobile){toggleClass(list,'expanded');toggleClass(mobileButton,'text');toggleClass(list,'fade');toggleClass(e.target,'clicked');}
var target=current.getAttribute('href')?current.getAttribute('href'):false;if("facebook"===current.getAttribute("data-antavo-share")){FB.ui({method:"share",href:target||window.top.location.href,display:"iframe"},function(response){if(response){Antavo.SDK.send("share",{network:"facebook",url:target||window.top.location.href});Antavo.Popup.display(Antavo.Popup.getShareUrl(Antavo.SDK.getBrandUrl())+'/success');}});}else{Antavo.Popup.display(buildFrameUrl(current.getAttribute('data-antavo-share'),target,current.getAttribute('data-antavo-share-preset')?current.getAttribute('data-antavo-share-preset'):null));}}});}
function inject(){var s=document.createElement('link'),f=document.getElementsByTagName('link')[0],is_guest=!Antavo.SDK.getCustomerId()||Antavo.SDK.getCustomerId()=='',guestMessage=Antavo.SDK.getBrandId()==9||Antavo.SDK.getBrandId()==28658?'':'<small>Sign up or log in to start collect points.</small>',networks=extension_info.networks,template;if(!document.getElementById('antavo_loyalty_social_share_css')){s.setAttribute('href',Antavo.SDK.getCDNUrl()+'/css/loyalty/social_share.css');s.setAttribute('rel','stylesheet');s.setAttribute('type','text/css');s.setAttribute('id','antavo_loyalty_social_share_css');f.parentNode.insertBefore(s,f);}
if(networks&&networks.length>0&&Antavo.Popup){if(Antavo.SDK.getBrandId()==9||Antavo.SDK.getBrandId()==28658){template='<div class="la-social-share-block" style="opacity: 0;"><a data-mobile-share-button></a><ul class="la-social-share-list">';}else{template='<div class="la-social-share-block" style="opacity: 0;"><a data-mobile-share-button><strong data-social-share-points>750</strong><span data-social-share-points-label>&nbsp;points</span></a><ul class="la-social-share-list"><li class="la-social-share-points"><span class="la-social-share-points-label" data-social-share-points>250</span><span data-social-share-points-label>&nbsp;points</span>';if(is_guest)template+=guestMessage;template+='</li>';}
for(var i=0;i<networks.length;i++){if(networks[i]!=='email'){template+='<li><a data-antavo-share="'+networks[i]+'">';if(is_guest)template+=guestMessage;template+='</a></li>';}}
template+='</ul></div>';Antavo.Popup.injectTemplate(template);}}
function getShareUrl(){return Antavo.SDK.getExtensionInfo('socialshare','url')||'';}
function createPopupFrame(){var properWindow=window.parent,doc=properWindow.document,frame=doc.createElement('IFRAME');frame.setAttribute('id','la-social-share-popup-frame');return doc.body.appendChild(frame);}
function getFrame(){return window.parent.document.getElementById('la-social-share-popup-frame')||createPopupFrame();}
function getKeyFromChannelName(channel){var map={facebook:'f',twitter:'b',email:'e'};return map[channel]||'';}
function buildFrameUrl(type,target,message){var share_url=target||window.top.location.href,composed_url=new Antavo.URL(getShareUrl()?(getShareUrl()+'/'+type):window.top.location.href),customer_id;if(share_url&&!share_url.match(Antavo.Automation.getCheckRegexp())&&(customer_id=Antavo.SDK.getCustomerId())){var huid=window.btoa(customer_id),url=new Antavo.URL(share_url);huid=huid.indexOf('=')>-1?huid.substr(0,huid.indexOf('=')):huid;if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){url.hash='__s'+huid;}else{url.params['__s']=huid;}
share_url=url.toString();}
share_url=encodeURIComponent(share_url);if(Antavo.SDK&&Antavo.SDK.getCustomerId()){composed_url.params['url']=share_url+'|'+getKeyFromChannelName(type);if(message){composed_url.params['message']=encodeURIComponent(message);}}else{composed_url.params['url']=share_url;if(message){composed_url.params['message']=encodeURIComponent(message);}}
return composed_url.toString();}
function display(){}
function callPopup(type){var popup=document.querySelector('.la-social-share-popup');var frame=getFrame();if(popup){popup.classList.remove('hidden');popup.removeAttribute('hidden');frame.setAttribute('src',buildFrameUrl(type));frame.onload=function(){var talker;popup.classList.remove('loading');this.classList.add('open');this.removeAttribute('hidden');talker=new Talker(frame.contentWindow,'*');talker.send('antavoSocialShare',{command:'content-loaded'});this.onload=null;};popup_visible=true;}}
function closePopup(){var popup=document.querySelector('.la-social-share-popup');var frame=getFrame();if(popup){popup.setAttribute('hidden',true);popup.classList.add('hidden');popup.classList.add('loading');popup_visible=false;}
if(frame){frame.setAttribute('hidden',true);}}
function handleError(errorMessage){var frame=getFrame();frame.classList.add('error');frame.setAttribute('data-error-message',errorMessage);}
function handleSuccess(){getFrame().classList.add('success');}
function getMetaFromPage(){var metas=document.getElementsByTagName('meta');for(var i=0;i<metas.length;i++){switch(metas[i].getAttribute('property')){case'og:title':share_object.og_title=metas[i].getAttribute('content');break;case'og:description':share_object.og_description=metas[i].getAttribute('content');break;case'og:url':share_object.og_url=metas[i].getAttribute('content');break;case'og:image':share_object.og_image_url=metas[i].getAttribute('content');break;case'image':share_object.image_url=metas[i].getAttribute('content');break;case'url':share_object.url=metas[i].getAttribute('content');break;case'description':share_object.description=metas[i].getAttribute('content');break;case'title':share_object.title=metas[i].getAttribute('content');break;default:break;}}
if(document.querySelector('title')){share_object.defaultTitle=document.querySelector('title').innerHTML;}
return share_object;}
function share(type){getMetaFromPage();callPopup(type);}
function hashify(message){var hash=0,i,chr,len;if(message.length===0)return hash;for(i=0,len=message.length;i<len;i++){chr=message.charCodeAt(i);hash=((hash<<5)-hash)+chr;hash|=0;}
if(hash<0){hash=hash*(-1);}
return hash;}
function storeShareMessage(message){if(typeof message!='undefined'){Antavo.Cookie.set('__las'+hashify(window.top.location.hostname.toString()),JSON.stringify(message),180);}}
function clearShareMessage(){Antavo.Cookie.set('__las'+hashify(window.top.location.hostname.toString()),'',10);}
function getStoredShareMessage(){var cookie=Antavo.Cookie.get('__las'+hashify(window.top.location.hostname.toString()));if(cookie&&typeof cookie!='undefined'&&cookie!=''){return JSON.parse(cookie);}
return false;}
function refreshPoints(){if(Antavo.SDK.getBrandId()==9||Antavo.SDK.getBrandId()==28658)return false;var points=document.querySelectorAll('[data-social-share-points]'),value=Antavo.SDK.getExtensionInfo('socialshare');for(var i=0;i<points.length;i++){if(points[i]&&value&&value.points!=null){points[i].innerHTML='+'+value.points;}}}
function refreshPointLabels(){if(Antavo.SDK.getBrandId()==9||Antavo.SDK.getBrandId()==28658)return false;var label=document.querySelectorAll('[data-social-share-points-label]'),value=Antavo.SDK.getKey('lm_points_label')||'points';for(var i=0;i<label.length;i++){if(label[i]&&value&&value!=null){label[i].innerHTML='&nbsp;'+value;}}}
function injectCSS(){var extension=Antavo.SDK.getExtensionInfo("socialshare");if(extension&&extension.hasOwnProperty("style")){var style=extension.style;if(style&&style.length){var d=document,o=d.createElement("link"),c=d.getElementsByTagName("title")[0];o.setAttribute("href",extension.style);o.setAttribute("rel","stylesheet");o.setAttribute("type","text/css");c.parentNode.insertBefore(o,c);}}}
function init(){if(Antavo.SDK.getBrandId()){extension_info=Antavo.SDK.getExtensionInfo('socialshare');extension_option=Antavo.SDK.getOption('socialShare');if(extension_info){injectCSS();}
if(extension_info&&extension_option&&extension_option.enabled){talker=new Talker(window.parent,'*');inject();talker.onMessage=function(message){if(message.namespace==='antavoSocialShare'){if(message.data.command=='content-loaded'){}}};checkForJoin();initEventListeners();setAlignment();refreshPoints();refreshPointLabels();}}else{setTimeout(function(){init();},1000);}}
init();var ShareButtons={};ShareButtons.init=init;ShareButtons.display=display;ShareButtons.popup=callPopup;ShareButtons.handleError=handleError;ShareButtons.share=share;ShareButtons.storePreLoginState=storePreLoginState;ShareButtons.getMetaDataFromPage=getMetaFromPage;ShareButtons.storeShareMessage=storeShareMessage;ShareButtons.clearShareMessage=clearShareMessage;ShareButtons.getStoredShareMessage=getStoredShareMessage;Antavo.ShareButtons=ShareButtons;}(document));var Antavo=window.Antavo||{};(function(document){"use strict";var EVENT_SHOW='antavo_sdk_show_notification';var
toastClass='antavo-toast',toastSelector='.'+toastClass,anchorClass='antavo-toast-link',anchorSelector='.'+anchorClass,titleClass='antavo-toast-title',titleSelector='.'+titleClass,textClass='antavo-toast-text',textSelector='.'+textClass,imageClass='antavo-toast-image',imageSelector='.'+imageClass,showClass='burnt',pauseClass='paused',toastShowing=false,toastPaused=false;var htmlContent="<a href='' class='antavo-toast-link' target='_blank'>"+"<div class='antavo-toast-image'></div>"+"<p class='antavo-toast-title'></p>"+"<span class='antavo-toast-text'></span>"+"</a>";var queue=[];var displayed=[];function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min;}
function create(){var nt=document.createElement('DIV');nt.className=toastClass;nt.innerHTML=htmlContent;return document.body.appendChild(nt);}
function getElement(){return document.querySelector(toastSelector)||create();}
function pause(){toastShowing=true;toastPaused=true;return getElement().classList.add(pauseClass);}
function unpause(){toastPaused=false;return getElement().classList.remove(pauseClass);}
function hide(){if(!toastPaused){toastShowing=false;toastPaused=false;return getElement().classList.remove(showClass);}
setTimeout(hide,1000);}
function addUtmToUrl(url){var newHref=new Antavo.URL(url);newHref.params.utm_medium="toast";newHref.params.utm_campaign="points";if(window.location.toString().indexOf(url)<0){newHref.params.utm_source="website";}else{newHref.params.utm_source="microsite";}
return newHref;}
function show(title,text,image,internal,callback,theme,demo){if(!isToastEnabled()){return;}
var elem=getElement(),brandUrl=Antavo.SDK&&Antavo.SDK.getBrandUrl(),alignment;if(brandUrl){elem.querySelector(anchorSelector).setAttribute("href",addUtmToUrl(brandUrl).toString());}else{elem.querySelector(anchorSelector).removeAttribute('href');}
if(Antavo.SDK!==undefined){elem.setAttribute('data-details',Antavo.SDK.getKey('lm_details_label','Details'));}
elem.querySelector(titleSelector).innerHTML=title;elem.querySelector(textSelector).innerHTML=text||'';elem.className=theme?toastClass+' '+theme+' '+showClass:toastClass+' '+showClass;elem.classList.add('thirdparty');if(internal){elem.classList.add('internal');}
if(Antavo.Widget!==undefined){if(Antavo.Widget.isSidebarOpen()){elem.classList.add('sidebar');}else if(alignment=Antavo.Widget.isWidgetShowing()){elem.classList.add(alignment.vertical+'-'+alignment.horizontal);elem.classList.add('widget');}}
if(!text||text===''){elem.classList.add('notext');}
if(image){elem.querySelector(imageSelector).style.backgroundImage='url('+image+')';elem.querySelector(imageSelector).style.backgroundColor='transparent';}else{elem.querySelector(imageSelector).style.backgroundColor='#febd00';elem.querySelector(imageSelector).style.backgroundImage='url('
+Antavo.SDK.getCDNUrl()
+'/img/loyalty/anonymous.png)';elem.querySelector(imageSelector).classList.remove('hide');}
elem.addEventListener('mouseover',pause);elem.addEventListener('mouseout',unpause);toastShowing=true;if(callback&&typeof callback==='function'){callback.call(window,elem);}
if(!demo){setTimeout(hide,8000);}
return elem;}
function display(msg){if((!Antavo.SDK.getKey('lm_got_points_now')&&!Antavo.SDK.getKey('lm_points_withdrawn'))||!isToastEnabled()){return;}
var points=msg.data.points;if(displayed.indexOf(msg.id)>-1){Antavo.Event.trigger(document,'antavo_sdk_notification_shown',msg);return;}
displayed.push(msg.id);show((msg.data.points===Math.abs(points))?Antavo.SDK.getKey('lm_got_points_now'):Antavo.SDK.getKey('lm_points_withdrawn','Oh, we are sorry'),'<strong>'+points+'</strong> '+Antavo.SDK.getKey('lm_points_label'),Antavo.SDK.getCustomer().image_url,null,function(elem){var i,seed;var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),density=80,sizeSet=[12,10,32,14,16,22,48,13,24,15,9],oldcanvas=elem.querySelector('canvas');canvas.width=275;canvas.height=94;for(i=0;i<density;i++){seed=Math.round(Math.random()*10);ctx.font=sizeSet[seed]+'px Arial Black';ctx.fillStyle='rgba(255,255,255,'+Math.random().toFixed(2)+')';ctx.fillText(points,getRandomInt(0,275),getRandomInt(0,94));}
if(oldcanvas){oldcanvas.parentNode.removeChild(oldcanvas);}
elem.appendChild(canvas);Antavo.Event.trigger(document,'antavo_sdk_notification_shown',msg);});}
function processQueue(){var msg;if(!toastShowing){msg=queue.shift();if(msg){display(msg);}}else{setTimeout(processQueue,500);}}
function eventHandler(e){queue.push(e.detail);processQueue();}
function setEventHandlers(){document.addEventListener(EVENT_SHOW,eventHandler);}
function init(){if(Antavo.SDK.getBrandId()){setEventHandlers();Antavo.SDK.injectStyleSheet();}else{setTimeout(init,500);}}
function isToastEnabled(){return!!Antavo.SDK.getExtensionInfo("toast");}
var Toast={};Toast.init=init;Toast.setEventHandlers=setEventHandlers;Toast.show=show;Toast.hide=hide;Toast.EVENT_SHOW=EVENT_SHOW;Antavo.Toast=Toast;}(document));var Antavo=window.Antavo||{};Antavo.Automation=(function(parent){var pointPlaceholders=[],limitPointPlaceholders=[],u,keyStr="ABCDEFGHIJKLMNOP"+"QRSTUVWXYZabcdef"+"ghijklmnopqrstuv"+"wxyz0123456789+/"+"=",hashChanged=false,hashChangeNeeded=false,hashprefix='__s',delimiter='|',events={'TRACKING_CHANGED':'antavo_sdk_tracking_hash_changed'},initialURL,hcid='',eventSent=false;function init(){u=new Antavo.URL(window.parent.location);storeURL();if(Antavo.SDK.getBrandId()){var consumptionExtension=Antavo.SDK.getExtensionInfo('contentconsumption');var trackingExtension=Antavo.SDK.getExtensionInfo('newslettertracking');autoTrack();if(trackingExtension&&trackingExtension.enabled){trackNewsletterCampaign();}
if(Antavo.SDK.getOption('tracking','autoSend')){document.addEventListener('scroll',function(event){var bodyScrollTop=document.documentElement.scrollTop||document.body.scrollTop;if(!eventSent&&(bodyScrollTop>=(document.body.clientHeight-window.innerHeight)*0.5)){sendVisitEvent();}});}else if(consumptionExtension&&consumptionExtension.hasOwnProperty('visit')&&consumptionExtension.visit&&consumptionExtension.hasOwnProperty('quiz_url')&&!consumptionExtension.quiz_url){sendVisitEvent();}}else{setTimeout(function(){init();},500);}}
function sendVisitEvent(){Antavo.SDK.send('visit',{url:u.toString()});setEventSent();}
function autoTrack(){if(u.params["__al"]){delete u.params["__al"];if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){u.hash=null;}else{delete u.params[hashprefix];}
history.replaceState(null,null,u.toString());sendVisitEvent();}
parseUri();}
function trackNewsletterCampaign(){if(u.params["__alc"]&&u.params["__aln"]){var finalUrl=u.protocol+'://'+u.host+u.path;Antavo.SDK.send('newsletter_click',{url:finalUrl,campaign:u.params["__aln"]},u.params["__alc"]);}}
function getCheckRegexp(){if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){return new RegExp("#__s([A-Za-z0-9\+\/\=]+)","g");}
return new RegExp("[\?|&]__s=([A-Za-z0-9\+\/\=]+)","g");}
function hasCustomerHash(){var r=getCheckRegexp(),m=r.exec(decodeURIComponent(window.location.toString()));if(m&&decode64(m[1])){var hcid=decode64(m[1]);hcid=hcid.trim().replace(/[^\x20-\x7E]+/g,'');if(Antavo.SDK.getCustomerId()==hcid){return true;}else{hashChangeNeeded=true;return false;}}else{return false;}}
function getCustomerHash(){if(Antavo.SDK.getCustomerId()){var hash=encode64(Antavo.SDK.getCustomerId());return hash.indexOf('=')>-1?hash.substr(0,hash.indexOf('=')):hash;}
return false;}
function setCustomerHash(){if(Antavo.SDK.getCustomerId()&&Antavo.SDK.getOption('tracking','setHash')===true){if(!hashChangeNeeded){var nu=new Antavo.URL(window.parent.location),nh=encode64(Antavo.SDK.getCustomerId());nh=nh.indexOf('=')>-1?nh.substr(0,nh.indexOf('=')):nh;if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){nu.hash=hashprefix+nh;}else{nu.params[hashprefix]=nh;}
history.replaceState(null,null,nu.toString());window.addEventListener('hashchange',setCustomerHash);}else{setTimeout(function(){setCustomerHash();},500);}}}
function getChannelNameFromPostfix(flag){var channels={'f':'facebook','b':'twitter','t':'tumblr','e':'email','p':'pinterest','g':'google'};for(var i in flag){if(typeof channels[flag[i]]!='undefined'){return channels[flag[i]].toString();}}}
function getChannelNameFromReferrer(){var channelRegexpMap={facebook:/(facebook.com)/,twitter:/(\/t.co\/)/,tumblr:/(t.umblr.com)/,pinterest:/(pinterest.com)/,google:/(google.com)/};if(document.referrer&&document.referrer!=''&&typeof document.referrer!='undefined'){for(var pattern in channelRegexpMap){if(document.referrer.match(channelRegexpMap[pattern])){return pattern.toString();}}}
return'';}
function getPrefixedCustomerHash(channel){if(Antavo.SDK.getCustomerId()){var hash,channelPostfix=channel?delimiter+channel:'',source='',nh=encode64(Antavo.SDK.getCustomerId());nh=nh.indexOf('=')>-1?nh.substr(0,nh.indexOf('=')):nh;hash=hashprefix+nh+channelPostfix;if(channelPostfix==''){source=getChannelNameFromReferrer();}else{source=getChannelNameFromPostfix(channelPostfix);}
storeTrafficSource(source);return hash;}}
function storeTrafficSource(channel){if(channel&&channel.length>0&&!Antavo.Cookie.get('__ats')){Antavo.Cookie.set('__ats',channel,2592000);}}
function openCoupon(flags){var hcid=decode64(flags[1]);hcid=hcid.trim().replace(/[^\x20-\x7E]+/g,'');if(Antavo.SDK.getCustomerId()!=hcid){var referral=Antavo.SDK.getExtensionInfo('friendreferral');if(referral.url&&referral.display_popup){Antavo.Popup.display(referral.url+'/coupon?referrer='+hcid+(Antavo.isMobile().any()?'?mobile=true':''));}}}
function openContest(contestID){var contestURL=Antavo.SDK.getExtensionInfo('contests','url');if(contestURL&&contestID){Antavo.Popup.display(contestURL+'/'+contestID);}}
function handleHashFlag(flags){var contestLink=flags[5],flagArray=flags[3].split('');for(var i=0;i<flagArray.length;i++){if(flagArray[i].toLowerCase()=='c'&&typeof contestLink!='undefined'){openContest(contestLink);}else if(flagArray[i].toLowerCase()=='r'){openCoupon(flags);}}}
function getSocialChannel(){var regexp=Antavo.SDK.getOption('tracking','hashMethod')==='hash'?new RegExp("#__s([A-Za-z0-9\+\/\=]+)(\\|([fbtgerpc]+))(\\|([a-f0-9]\\w+))?","g"):new RegExp("[\?|&]__s=([A-Za-z0-9\+\/\=]+)(\\|([fbtgerpc]+))(\\|([a-f0-9]\\w+))?","g"),location=regexp.exec(decodeURIComponent(window.location.toString()));if(location&&typeof location[3]!='undefined'){storeTrafficSource(getChannelNameFromPostfix(location[3]));handleHashFlag(location);}else{storeTrafficSource(getChannelNameFromReferrer());}}
function storeURL(){if(!initialURL){initialURL=decodeURIComponent(window.location.toString());Antavo.Event.trigger(document,'hash-stored',{});}}
function getStoredURL(){return initialURL;}
function isImpressionSendingEnabled(){return Antavo.SDK.getExtensionInfo('share_impression','enabled');}
function parseUri(){var r=getCheckRegexp(),m=r.exec(decodeURIComponent(window.location.toString())),refc=Antavo.Cookie.get('__alr');if(m&&decode64(m[1])){hcid=decode64(m[1]);hcid=hcid.trim().replace(/[^\x20-\x7E]+/g,'');getSocialChannel();if(Antavo.SDK.getCustomerId()!=hcid){var flags=window.location.toString().match(/__s[A-Za-z0-9\+\/\=]+\|(\w+)/);flags=flags&&flags[1];if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){u.hash='';}else{delete u.params[hashprefix];}
history.replaceState(null,null,u.toString());if(!refc&&flags&&flags.indexOf('r')>=0){Antavo.Cookie.set('__alr',hcid,7776000,'/',Antavo.SDK.getTopDomain());}
var
props={url:u.toString()},visitor=Antavo.SDK.getVisitor();if(document.referrer){props.referrer=document.referrer;}
if(visitor){props.visitor=visitor;}
if(isImpressionSendingEnabled()){Antavo.SDK.send('share_impression',props,hcid);}}
if(Antavo.SDK.getCustomerId()){var nu=new Antavo.URL(window.parent.location),nh=encode64(Antavo.SDK.getCustomerId());nh=nh.indexOf('=')>-1?nh.substr(0,nh.indexOf('=')):nh;if(Antavo.SDK.getOption('tracking','hashMethod')==='hash'){nu.hash=hashprefix+nh;}else{nu.params[hashprefix]=nh;}
history.replaceState(null,null,nu.toString());hashChangeNeeded=false;Antavo.Event.trigger(document,events.TRACKING_CHANGED);}}}
function updatePoints(points){pointPlaceholders=document.querySelectorAll('.alms-point-placeholder');for(var i=0;i<pointPlaceholders.length;i++){pointPlaceholders[i].innerHTML=points;}}
function updateLimitPoints(points){var limitbar=document.querySelector('[data-daily-limit]');limitPointPlaceholders=document.querySelectorAll('[data-limit-point]');for(var i=0;i<limitPointPlaceholders.length;i++){var o=parseInt(limitPointPlaceholders[i].innerHTML.replace(/\s+/g,'')),n=o-points;if(limitbar){var percent=100-parseInt((n / limitbar.getAttribute('data-daily-limit'))*100);document.querySelector('[data-limit-progressbar]').style.width=percent+'%';}
if(n<=0){document.querySelector('.alms-messaging-container').classList.add('counter');document.querySelector('.alms-messaging-countdown-container-wrapper').classList.remove('hidden');}
limitPointPlaceholders[i].innerHTML=n>=0?Antavo.SDK.formatNumber(n):'0';}}
function encode64(input){input=escape(input);var output="";var chr1,chr2,chr3="";var enc1,enc2,enc3,enc4="";var i=0;do{chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
keyStr.charAt(enc1)+
keyStr.charAt(enc2)+
keyStr.charAt(enc3)+
keyStr.charAt(enc4);chr1=chr2=chr3="";enc1=enc2=enc3=enc4="";}while(i<input.length);return output;}
function decode64(input){var output="";var chr1,chr2,chr3="";var enc1,enc2,enc3,enc4="";var i=0;var base64test=/[^A-Za-z0-9\+\/\=]/g;if(base64test.exec(input)){return false;}
input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{enc1=keyStr.indexOf(input.charAt(i++));enc2=keyStr.indexOf(input.charAt(i++));enc3=keyStr.indexOf(input.charAt(i++));enc4=keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}
chr1=chr2=chr3="";enc1=enc2=enc3=enc4="";}while(i<input.length);return unescape(output);}
function isHashChanged(){return hashChanged;}
function isHashChangeNeeded(){return hashChangeNeeded;}
function isEventSent(){return eventSent;}
function setEventSent(){eventSent=true;}
return{events:events,decode64:decode64,init:init,updatePoints:updatePoints,updateLimitPoints:updateLimitPoints,getCustomerHash:getCustomerHash,setCustomerHash:setCustomerHash,hasCustomerHash:hasCustomerHash,isHashChanged:isHashChanged,isHashChangeNeeded:isHashChangeNeeded,getPrefixedCustomerHash:getPrefixedCustomerHash,storeTrafficSource:storeTrafficSource,getSocialChannel:getSocialChannel,getStoredURL:getStoredURL,getCheckRegexp:getCheckRegexp,isEventSent:isEventSent,setEventSent:setEventSent}})(Antavo);Antavo.Automation.init();var Antavo=window.Antavo||{};(function(document){'use strict';var popupClass='.la-popup-frame';var overlayClass='.la-popup-overlay';var popupId='la-social-share-popup-frame';var popupVisible=false;var talker;var isMobile=Antavo.isMobile().any()||false;var popupTemplate='<div class="la-popup-overlay"><div class="la-popup-frame loading hidden"><a href="#" data-close-popup></a><iframe src="" id="la-social-share-popup-frame" class="la-social-share-popup-content" hidden></iframe></div></div>';var fbPopupOpened=false;function isIE10(){var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){if(parseInt(ua.substring(msie+5,ua.indexOf(".",msie)))===10){return true;}}
return false;}
function injectStyleSheet(){if(Antavo.SDK.getBrandId()){var s=document.createElement('link'),f=document.getElementsByTagName('link')[0];if(!document.getElementById('antavo_popup_css')){s.setAttribute('href',Antavo.SDK.getCDNUrl()+'/css/loyalty/antavo-popup.css');s.setAttribute('rel','stylesheet');s.setAttribute('type','text/css');s.setAttribute('id','antavo_popup_css');if(typeof f!='undefined'&&f){f.parentNode.insertBefore(s,f);}else{document.querySelector('head').appendChild(s);}}}else{setTimeout(injectStyleSheet,500);}}
function injectTemplate(template){return document.getElementsByTagName('body')[0].appendChild(Antavo.DOM.fromString(template));}
function closePopup(){var popup=document.querySelector(popupClass),iframe=getFrame(),overlay=document.querySelector(overlayClass);overlay.classList.remove('la-popup-overlay-displayed');if(isIE10()){if(overlay){overlay.style.display='none';}}
if(popup){popup.setAttribute('hidden',true);popup.classList.add('hidden');popup.classList.add('loading');popupVisible=false;}
if(iframe){iframe.removeAttribute('src');iframe.setAttribute('hidden',true);}
resizeFrame(0,0);if(Antavo.SDK.getBrandId()==30000||Antavo.SDK.getBrandId()==30105){window.location.reload();}}
function getShareUrl(url){return Antavo.SDK.getExtensionInfo('socialshare','url')||(url+'/share/'+Antavo.SDK.getBrandId());}
function getFrameSource(result){if(Antavo.SDK.getBrandId()){switch(result[2]){case'0':display(getShareUrl(Antavo.SDK.getBrandUrl())+'/success');break;case'1':display(getShareUrl(Antavo.SDK.getBrandUrl())+'/facebook?url='+window.top.location);break;case'2':display(getShareUrl(Antavo.SDK.getBrandUrl())+'/twitter?url='+window.top.location);break;case'3':display(getShareUrl(Antavo.SDK.getBrandUrl())+'/email?url='+window.top.location);break;default:}}else{setTimeout(function(){getFrameSource(result);},500);}}
function hashChangeHandler(event){var regexp=new RegExp("(\\#la_popup)=([0-9]{1})","g"),hash=event.newURL||event,result=regexp.exec(hash);if(result&&result[2]){getFrameSource(result);var url=window.top.location.toString().split("#")[0];window.history.pushState('','',url);}}
function initEventListeners(){var popup=document.querySelector(popupClass),popupClose=popup.querySelector('[data-close-popup]');if(popupClose){popupClose.addEventListener('click',function(event){event.preventDefault();closePopup();});}
document.addEventListener('hash-stored',function(event){hashChangeHandler(Antavo.Automation.getStoredURL());});hashChangeHandler(Antavo.Automation.getStoredURL());window.onhashchange=hashChangeHandler;}
function createPopupFrame(){var properWindow=window.parent,doc=properWindow.document,frame=doc.createElement('IFRAME');frame.setAttribute('id',popupId);return doc.body.appendChild(frame);}
function getFrame(){return window.parent.document.getElementById('la-social-share-popup-frame')?window.parent.document.getElementById(popupId):createPopupFrame();}
function sendTrackEvent(src){if(typeof ga!='undefined'&&ga){ga('send','event','Popup','open',src);}else{Antavo.AJAX.get(Antavo.SDK.getBrandUrl()+'/track/popup?url='+src);}}
function resizeFrame(height,width){var iframe=document.querySelector(popupClass);height=getNearestEvenNumber(height);width=getNearestEvenNumber(width);if(iframe&&(Antavo.SDK.getBrandId()==30000||Antavo.SDK.getBrandId()==30105||Antavo.SDK.getBrandId()==635)){document.querySelector(".la-popup-overlay").style='background-color: #0000009c';iframe.setAttribute('style','height: 600px; width: 520px');return;}
if(iframe&&!isMobile&&width){iframe.setAttribute('style','height: '+height+'px; width: '+width+'px');}else if(iframe&&width>200){iframe.setAttribute('style','height: '+height+'px; width: '+width+'px');}else if(iframe){iframe.setAttribute('style','height: '+height+'px');}}
function getNearestEvenNumber(number){return 2*Math.round(number / 2);}
function addClassToFrame(newClass){var popup=document.querySelector(popupClass);if(popup){popup.classList.add(newClass);}}
function removeClassesFromFrame(){var popup=document.querySelector(popupClass);if(popup){popup.className=popupClass.split('.')[1];}}
function setMobileView(popup){if(isMobile){popup.classList.add('mobile');}}
function initPopupListeners(frame){talker=new Talker(frame.contentWindow,'*');talker.send('antavoSocialShare',{command:'content-loaded',data:Antavo.ShareButtons.getStoredShareMessage(),url:Antavo.SDK.getBrandUrl(),share_url:Antavo.SDK.getExtensionInfo('socialshare','url'),hash_based:Antavo.SDK.getOption('tracking','hashMethod')==='hash',id:Antavo.SDK.getBrandId(),mobile:Antavo.isMobile().any()||window.parent.document.body.getBoundingClientRect().width<640});talker.send('antavoSocialShare',{command:'share-object',data:Antavo.ShareButtons.getMetaDataFromPage()});talker.send('antavoSocialShare',{command:'previous-dialog',data:Antavo.ShareButtons.getStoredShareMessage(),url:Antavo.SDK.getBrandUrl(),id:Antavo.SDK.getBrandId()});talker.send('antavoPopup',{command:'content-loaded'});if(isMobile){talker.send('antavoPopup',{command:'mobile-view'});addClassToFrame('mobile');}
talker.onMessage=function(message){if(message.namespace==='antavoSocialShare'){if(message.data.command=='store-dialog'){Antavo.ShareButtons.storeShareMessage(message.data.data);}else if(message.data.command=='resize-frame'){resizeFrame(message.data.height,message.data.width);if(message.data.addClass&&message.data.addClass!=''){addClassToFrame(message.data.addClass);}}else if(message.data.command=='open-popup'){var target=message.data.url+'?url='+window.top.location.toString();if("facebook"===message.data.network){Antavo.Popup.close();if(!fbPopupOpened){fbPopupOpened=true;FB.ui({method:"share",href:target||window.top.location.href,display:"iframe"},function(response){fbPopupOpened=false;if(response){Antavo.SDK.send("share",{network:"facebook",url:target||window.top.location.href});Antavo.Popup.display(Antavo.Popup.getShareUrl(Antavo.SDK.getBrandUrl())+'/success');}});}}else{display(target);}}else if(message.data.command=='close-popup'){closePopup();}else if(message.data.command=='clear-cookie'){Antavo.ShareButtons.clearShareMessage();}else if(message.data.command=='store-login-state'){Antavo.ShareButtons.storePreLoginState(window.top.location.toString(),message.data.network);}else if(message.data.command=='redirect-view'){document.querySelector('[data-close-popup]').classList.add('hidden');}else if(message.data.command=='redirect'){if(message.data.target){window.location=message.data.target;}}else if(message.data.command=='add-class'){document.querySelector(message.data.selector).classList.add(message.data.class);}else if(message.data.command==='scotty-beam-me-up'){var offset=message.data.offset||0;if(window.jQuery){jQuery('html, body').stop().animate({scrollTop:jQuery(frame).offset().top+offset},1000);}else{console.warn('Sorry, this command needs jQuery to function');}}}else if(message.namespace==='antavoPopup'){if(message.data.command=='resize-frame'){resizeFrame(message.data.height,message.data.width);}else if(message.data.command=='hideQuizWidget'){Antavo.Quiz.hide();}}};}
function appendLocale(src){var a,url,locale=Antavo.SDK.getOption('locale');if(locale&&locale!=null){a=new Antavo.URL(src);url=a.params['url'];a.params['locale']=locale.toString().toLowerCase();if(url){delete a.params['url'];a.params['url']=url;}
return a.toString();}
return src;}
function display(src){var popup=document.querySelector(popupClass),frame=getFrame(),overlay=document.querySelector(overlayClass);overlay.classList.add('la-popup-overlay-displayed');src=appendLocale(src);if(isIE10()){if(overlay){overlay.style.display='block'}}
if(popup){if(frame.getAttribute('src')!=decodeURIComponent(src)||!popupVisible){popup.classList.remove('hidden');popup.removeAttribute('hidden');popup.classList.add('loading');popup.classList.remove('open');setMobileView(popup);resizeFrame(200,150);frame.setAttribute('src',decodeURIComponent(src));frame.onload=function(){resizeFrame(126,150);removeClassesFromFrame();popup.classList.remove('loading');this.classList.add('open');this.removeAttribute('hidden');initPopupListeners(frame);};sendTrackEvent(src);popupVisible=true;}}}
function init(){injectStyleSheet();if(!document.querySelector(popupClass)){injectTemplate(popupTemplate);}
initEventListeners();if(isIE10()){var overlay=document.querySelector(overlayClass);if(overlay){overlay.style.display='none';}}}
init();var Popup={};Popup.init=init;Popup.close=closePopup;Popup.injectTemplate=injectTemplate;Popup.display=display;Popup.resizeFrame=resizeFrame;Popup.getShareUrl=getShareUrl;Antavo.Popup=Popup;}(document));var Antavo=window.Antavo||{};(function(document){'use strict';var campaigns=[];var snippets=[];var snippet_selector='[data-aip-value]';var summary_snippet_selector='[data-aip-summary]';var snippet_property_attribute='data-aip-properties';var snippet_tense_attribute='data-aip-tense';var snippet_value_attribute='data-aip-value';var percentage;function parse(elements,snippets){for(var i=0;i<elements.length;i++){snippets.push(elements[i]);}
return snippets;}
function getSnippetsOnPage(){return document.querySelectorAll(snippet_selector);}
function generate(snippets){var product,point;[].forEach.call(snippets,function(snippet){product=getProductProperty(snippet);if(typeof product==='object'){point=getPointsForProducts([product],getCampaigns(),getPercentage());}else{point=calcPoints(product,getPercentage(),1);}
replaceHTML(snippet,replacePoint(Antavo.SDK.getKeys(),point),snippet.getAttribute(snippet_tense_attribute));});}
function replaceHTML(element,replaced_keys,tense){tense=tense||1;element.innerHTML=replaced_keys[tense];return element;}
function getProductProperty(element){var prop,attr;if(attr=element.getAttribute(snippet_property_attribute)){try{prop=JSON.parse(attr);}catch(e){if(typeof window[attr]==='object'){prop=window[attr];}else{prop=element.getAttribute(snippet_value_attribute)||0;}}}else{prop=element.getAttribute(snippet_value_attribute)||0;}
return prop;}
function setCampaigns(response){return campaigns=response;}
function getCampaignSegmentId(campaign){return campaign['modules']['incentivizedpurchase']['segment'];}
function isCustomerInSegment(customer,segment_id){if(!customer){return false;}
for(var i=0;i<customer.segments.length;i++){if(customer.segments[i][segment_id]){return true;}}
return false;}
function getCampaigns(){return[].filter.call(campaigns,function(campaign){var customer=Antavo.SDK.getCustomer(),segment_id=getCampaignSegmentId(campaign);if(!segment_id||isCustomerInSegment(customer,segment_id)){return true;}});}
function getPercentage(){return percentage;}
function replacePoint(keys,point){return[].map.call(keys,function(key){return key.replace(/%d/g,point);});}
function replacePointsObject(keys,point){return{past:keys[0].replace(/%d/g,point),present:keys[1].replace(/%d/g,point),future:keys[2].replace(/%d/g,point)}}
function calcPoints(points,percentage,multiplier,amount){console.log(points);console.log(amount);console.log(1*amount);console.log(points+amount);if(typeof amount!=='undefined'){return(points+(1*amount)).toFixed();}
return(parseFloat(typeof multiplier==='string'?multiplier.replace(",","."):multiplier)*(points*(percentage / 100))).toFixed();}
function filterMatches(product,filter){return filter.reduce(function(prev,current){return Boolean(prev&&filterGroupMatches(product,current));},true);}
function filterGroupMatches(product,filters){return filters.reduce(function(prev,current){return Boolean(prev||isFilterValid(product[current.property],current.operator,current.value));},false);}
function campaignMatches(product,campaign){return filterMatches(product,campaign['modules']['incentivizedpurchase']['filters']);}
function getMatchingCampaign(product,campaigns,value,percentage){var match=false,points=0,current=0;[].forEach.call(campaigns,function(campaign){if(campaignMatches(product,campaign)){campaign=campaign['modules']['incentivizedpurchase'];if(campaign.calculation==='multiply'){current=parseInt(calcPoints(value,percentage,campaign.value));}else{current=parseInt(calcPoints(value,percentage,1,campaign.value));}
if(current>points){points=parseInt(current);match=campaign;}}});return match;}
function getMatchingCampaignEndDate(product,campaigns,value,percentage){var match=false,points=0,current=0;[].forEach.call(campaigns,function(campaign){var endDate=campaign.end_date;if(campaignMatches(product,campaign)){campaign=campaign['modules']['incentivizedpurchase'];if(campaign.calculation==='multiply'){current=parseInt(calcPoints(value,percentage,campaign.value));}else{current=parseInt(calcPoints(value,percentage,1,campaign.value));}
if(current>points){points=parseInt(current);match=endDate;}}});return match;}
function getPointsForProducts(products,campaigns,percentage){var points=[];[].forEach.call(prepareProducts(products),function(product){var campaign;if(campaign=getMatchingCampaign(product,campaigns,product.value,percentage)){if(campaign.calculation==='multiply'){points.push(calcPoints(product.value,percentage,campaign.value));}else{points.push(calcPoints(product.value,percentage,1,campaign.value));}}else{points.push(calcPoints(product.value,percentage,1));}});return points;}
function getPoints(products){return getPointsForProducts(products,getCampaigns(),getPercentage()).map(function(value){return parseInt(value);});}
function handleLineItemCampaign(campaigns,points,products){Object.values(campaigns).forEach(function(campaign){var incentivizedPurchase=campaign["modules"]["incentivizedpurchase"];incentivizedPurchase["filters"].forEach(function(filter){Object.values(filter).forEach(function(currentFilter){if("line_number"===currentFilter["property"]&&currentFilter["value"]<=Object.keys(products).length){points.splice(0,1,(points[0]*1+incentivizedPurchase["value"]).toString());}});});});return points;}
function getIncentivizedStrings(products,points){var strings=[],total=0,totalObj;[].forEach.call(products,function(product,index){var obj=replacePointsObject(Antavo.SDK.getKeys(),points[index]);if(product.hasOwnProperty('product_id')){obj.product_id=product.product_id;}
if(product.hasOwnProperty('product_name')){obj.product_name=product.product_name;}
total=parseInt(total)+parseInt(points[index]);strings.push(obj);});totalObj=replacePointsObject(Antavo.SDK.getKeys(),total);totalObj.total=true;strings.push(totalObj);return strings;}
function getRelevantCampaignEndDate(product){return getMatchingCampaignEndDate(product,getCampaigns(),product.value,percentage);}
function prepareProducts(products){var cart=calculateCart(products);return[].map.call(products,function(product,index){product.total=cart.total;product.total_quantity=cart.total_quantity;return product;});}
function calculateCart(products){var total=0,total_quantity=0;[].forEach.call(products,function(product,index){total+=product.subtotal||(product.value*(product.quantity||1));total_quantity+=product.quantity||1;});return{total:total,total_quantity:total_quantity};}
function getIncentivizedStringsForCart(keys,total,count){var cart;return replacePointsObject(Antavo.SDK.getKeys(),getPointsForProducts([cart={value:total,total:total,total_quantity:count}],getCampaigns(),getPercentage()));}
function getStrings(products){return getIncentivizedStrings(products,getPointsForProducts(products,getCampaigns(),getPercentage()));}
function isFilterValid(x,op,y){switch(op){case'start':return isStartWith(x,y);break;case'not_start':return isNotStartWith(x,y);break;case'end':return isEndWith(x,y);break;case'not_end':return isNotEndWith(x,y);break;case'contain':return isContains(x,y);break;case'not_contain':return isNotContains(x,y);break;case'equal':return isEqual(x,y);break;case'not_equal':return isNotEqual(x,y);break;case'less':return isLessThan(x,y);break;case'not_greater':return isLessThanEquals(x,y);break;case'greater':return isGreaterThan(x,y);break;case'not_less':return isGreaterThanEquals(x,y);break;case'between':return isBetween(x,y);break;case'exists':return isExists(x,y);break;case'not_exists':return isNotExists(x,y);break;default:console.error('Unsupported operator type:'+op);break;}}
function isEqual(x,y){if('undefined'===typeof x||'undefined'===typeof y){return false;}
if('string'==typeof x||'string'==typeof y){return x.toString().toLowerCase()===y.toString().toLowerCase();}
return x===y;}
function isNotEqual(x,y){return!isEqual(x,y);}
function isStartWith(x,y){return Boolean(x.match(new RegExp('^'+y,'i')));}
function isNotStartWith(x,y){return!isStartWith(x,y);}
function isEndWith(x,y){return Boolean(x.match(new RegExp(y+'$','i')));}
function isNotEndWith(x,y){return!isEndWith(x,y);}
function isGreaterThan(x,y){return x>y;}
function isLessThan(x,y){return x<y;}
function isGreaterThanEquals(x,y){return x>=y;}
function isLessThanEquals(x,y){return x<=y;}
function isBetween(value,interval){return value>=interval[0]&&value<=interval[1];}
function isContains(x,y){return isExists(x,null)&&x.toString().toLowerCase().indexOf(y.toString().toLowerCase())!=-1;}
function isNotContains(x,y){return!isContains(x,y);}
function isExists(x,y){return x!=null&&typeof x!='undefined'&&x!='';}
function isNotExists(x,y){return!isExists(x,y);}
function setPercentage(value){return percentage=value;}
function calculateCampaignBonus(data,callback){Antavo.AJAX.post(Antavo.SDK.getApiHost()+"/extensions/automation/campaign-bonus",{"api_key":Antavo.SDK.getAPIKey(),"customer":Antavo.SDK.getCustomerId(),"data":data||{}},function(response){let points=0;if(response.data&&response.data['purchase']&&response.data['purchase'].points){points=response.data['purchase'].points;}
if(callback){callback(replacePointsObject(Antavo.SDK.getKeys(),points));}});}
function init(){var extension_info,percentage;if(Antavo.SDK.getBrandId()){setPercentage(Antavo.SDK.getExtensionInfo('incentivizedpurchase','percentage')||100);if(extension_info=Antavo.SDK.getExtensionInfo('campaigns')){setCampaigns(extension_info.campaigns);}
generate(parse(getSnippetsOnPage(),snippets));}else{window.setTimeout(init,1000);}}
Antavo.Campaigns={init:init,getCampaigns:getCampaigns,getStrings:getStrings,getPoints:getPoints,getRelevantCampaignEndDate:getRelevantCampaignEndDate,calculateCampaignBonus:calculateCampaignBonus};}(document));var Antavo=window.Antavo||{};(function(document){"use strict";var
_POLL_INTERVALS=[60000,120000,300000],_ENDPOINT,messages=[],last_message_cookie_name='__altm',timeout_function,tier=0,sleeping=false,showing=false,toastClass='antavo-poll-toast',toastInnerClass='antavo-poll-toast-inner',toastPointClass='antavo-poll-toast-points',toastLinkClass='antavo-poll-toast-link',toastSelector='.'+toastClass,toastInnerSelector='.'+toastInnerClass,toastPointSelector='.'+toastPointClass,toastLinkSelector='.'+toastLinkClass,toastShowClass='antavo-poll-toast-show',toastHTMLString='<div class="'+toastInnerClass+'"><div class="'+toastPointClass+'"></div><a class="'+toastLinkClass+'"></a></div>';function getElement(){return document.querySelector(toastSelector)||create();}
function create(){var nt=document.createElement('DIV');nt.className=toastClass;nt.innerHTML=toastHTMLString;return document.body.appendChild(nt);}
function show(msg){var elem=getElement();showing=true;elem.querySelector(toastPointSelector).innerHTML=msg.points+'&nbsp;'+Antavo.SDK.getKey('lm_points_label','points');elem.classList.add(toastShowClass);}
function hide(){getElement().classList.remove(toastShowClass);showing=false;if(hasMessage()){setTimeout(showNextMessage,1000);}}
function hasMessage(){return Boolean(messages.length);}
function showNextMessage(){var msg=messages.shift();if(msg&&!showing&&(!getLastRegisteredMessage()||getLastRegisteredMessage()<msg.id)){registerLastMessage(msg.id);show(msg);}}
function getMessages(){if(sleeping){return false;}
Antavo.AJAX.get(_ENDPOINT,function(response){if(response.length>0){for(var i=0;i<response.length;i++){messages.push(response[i]);}
timeout_function=setTimeout(getMessages,_POLL_INTERVALS[tier]);showNextMessage();}else{if(tier>=_POLL_INTERVALS.length){sleeping=true;}
incrementTier();}},function(){console.error('Failed to load toast messages.');sleeping=true;return false;});}
function getLastRegisteredMessage(){return Antavo.Cookie.get(last_message_cookie_name)||false;}
function registerLastMessage(id){var cookie=Antavo.Cookie.get(last_message_cookie_name);if(cookie){Antavo.Cookie.expire(last_message_cookie_name,cookie,'/',Antavo.SDK.getTopDomain());}
Antavo.Cookie.set(last_message_cookie_name,id,'/',Antavo.SDK.getTopDomain());_ENDPOINT=_ENDPOINT+'&last='+id;return cookie;}
function incrementTier(){return tier>_POLL_INTERVALS.length?tier:++tier;}
function injectCSS(){var extension_info=Antavo.SDK.getExtensionInfo('toast');if(extension_info&&extension_info.hasOwnProperty('style')){var d=document,o=d.createElement('link'),c=d.getElementsByTagName('title')[0];o.setAttribute('href',extension_info.style);o.setAttribute('rel','stylesheet');o.setAttribute('type','text/css');c.parentNode.insertBefore(o,c);}}
function registerEvents(){document.addEventListener('click',function(e){if(Antavo.DOM.closest(e.target,'.antavo-poll-toast-link')){hide();}});}
function init(){if(Antavo.SDK.getBrandId()){var toast_extension=Antavo.SDK.getExtensionInfo('toast');if(toast_extension&&Antavo.SDK.getCustomerId()){_ENDPOINT=Antavo.SDK.getApiHost()+'/customers/'+Antavo.SDK.getCustomerId()+'/messages?api_key='+Antavo.SDK.getAPIKey();injectCSS();registerEvents();getMessages();}else{sleeping=true;return false;}}else{setTimeout(init,500);}}
var PollToast={};PollToast.init=init;PollToast.show=show;PollToast.hide=hide;Antavo.PollToast=PollToast;}(document));var Antavo=window.Antavo||{};Antavo.ReviewHelper=(function(parent){var placeholders,ratingPlaceholders,reviewFrame,talker=null,navigating=false,ratingWidgets=[],reviewContainerAttribute='data-ar-item-id',reviewContainerSelector='['+reviewContainerAttribute+']',customerIdAttribute='data-ar-customer-id',customerIdSelector='['+customerIdAttribute+']',itemUrlAttribute='data-ar-item-url',itemUrlSelector='['+itemUrlAttribute+']',ratingWidgetAttribute='data-arw-item',ratingWidgetModeAttribute='data-arw-mode',ratingWidgetSelector='['+ratingWidgetAttribute+']',ratingWidgetModeSelector='['+ratingWidgetModeAttribute+']';document.addEventListener('antavo_sdk_init_finished',function(){placeholders=document.querySelectorAll(reviewContainerSelector);ratingPlaceholders=document.querySelectorAll(ratingWidgetSelector);for(var i=0;i<placeholders.length;i++){parsePlaceholder(placeholders[i]);}
parseRatingWidgets();routeHashChange();});window.addEventListener('beforeunload',function(){navigating=true;});window.onhashchange=routeHashChange;function routeHashChange(){var hash=window.location.hash.substr(1),frame=document.querySelector('[data-antavo-review-thread-container], [class*="antavo-review-thread-container-"]');if(hash.indexOf('!submitReview')>-1){if(frame&&frame.src.indexOf('/create')==-1){frame.src=frame.src.replace('?','/create?');}else{setTimeout(function(){routeHashChange();},500);}}}
function parseRatingWidgets(){for(var r=0;r<ratingPlaceholders.length;r++){var
rp=ratingPlaceholders[r],ratingWidgetItemId=rp.getAttribute(ratingWidgetAttribute),ratingWidgetItemMode=rp.hasAttribute(ratingWidgetModeAttribute)?rp.getAttribute(ratingWidgetModeAttribute):'midi';ratingWidgets.push(ratingWidgetItemId);}
requestRatingReplacements(ratingWidgets);}
function requestRatingReplacements(ratingWidgets){if(Antavo.SDK.getBrandId()){if(ratingWidgets.length>0){var itemString='?items=';for(var i=0;i<ratingWidgets.length;i++){itemString+=ratingWidgets[i]+',';}
Antavo.AJAX.get(Antavo.SDK.getReviewsUrl()+'/items/'+itemString,function(data){for(var r=0;r<data.length;r++){generateRatingImage(data[r].id.toString(),data[r].rating.toString(),true);}
for(var a=0;a<ratingWidgets.length;a++){generateRatingImage(ratingWidgets[a].toString(),0,false);}});}}else{setTimeout(function(){requestRatingReplacements(ratingWidgets);},500);}}
function generateRatingImage(id,rating,reduce){var rimg=document.createElement('IMG'),index=ratingWidgets.indexOf(id);rimg.src=Antavo.SDK.getCDNUrl()+'/img/reviews/rating/'+parseInt(Math.round(rating))+'.png';document.querySelector('[data-arw-item="'+id+'"]').appendChild(rimg);if(reduce)ratingWidgets.splice(index,1);}
function scrollTo(element,to,duration){if(duration<0)return;var difference=to-element.scrollTop,perTick=difference / duration*10,isFirefox=typeof InstallTrigger!=='undefined';if(Antavo.isIE()||isFirefox){setTimeout(function(){document.documentElement.scrollTop=element.scrollTop+perTick;if(document.documentElement.scrollTop==to)return;scrollTo(document.documentElement,to,duration-10);},10);}else{setTimeout(function(){element.scrollTop=element.scrollTop+perTick;if(element.scrollTop==to)return;scrollTo(element,to,duration-10);},10);}}
function parsePlaceholder(placeholder){if(Antavo.SDK.getBrandId()){if(placeholder.querySelector('iframe')||placeholder.nodeName=='IFRAME'){var reframe=placeholder.nodeName=='IFRAME'?placeholder:placeholder.querySelector('iframe');reframe.style.width="100%";reframe.style.height="200";reframe.style.border='none';reframe.style.overflow='hidden';reframe.setAttribute('scrolling','no');}else{var reframe=document.createElement('iframe'),thread=placeholder.getAttribute(reviewContainerAttribute),customer=placeholder.hasAttribute(customerIdAttribute)?placeholder.getAttribute(customerIdAttribute):false,item_url=placeholder.getAttribute(itemUrlAttribute);reframe.src=customer?Antavo.SDK.getReviewsUrl()+'/items/'+thread+'/thread?item_url='+item_url+'&customer='+customer:Antavo.SDK.getReviewsUrl()+'/items/'+thread+'/thread?item_url='+item_url;reframe.className='antavo-review-thread-container-'+thread;reframe.style.width="100%";reframe.style.height="200";reframe.style.border='none';reframe.style.overflow='hidden';reframe.setAttribute('scrolling','no');placeholder.appendChild(reframe);}
talker=new Talker(reframe.contentWindow,'*');talker.onMessage=function(message){if(message.namespace==='antavoReviewFrame'){if(reframe.offsetParent!=null&&message.data.height){reframe.style.height=message.data.height+'px';}
if(message.data.scrollToTop&&!navigating){scrollTo(document.body,document.querySelector('[class*="antavo-review-thread-container-"], [data-antavo-review-thread-container], [data-ar-item-id]').offsetParent.offsetTop,600);}}};}else{setTimeout(function(){parsePlaceholder(placeholder);},500);}}})(Antavo);var Antavo=window.Antavo||{};Antavo.Widget=(function(parent){var
ready=false,polled=false,polledReward=false,lotteryDrawn=false,recommended=false,sidebarOpen=false,widgetShowing=false,ongoingQuiz=false,quiz,talker,options={alignment:'top-right',chance:5,frequency:2,on_hover:true},widgetContainer,widgetInner,widgetNotificationContainer,widgetRewardImg,widgetPoint,widgetIframe,sectionUrls={start:'http://apps-bugfix.antavo.local/quizzes/26206/activities/560a801b693f8b04388b4568'},selectors={widgetFrame:'antavo-widget-frame'},events={},message_classes={'GOT_POINTS':'antavo-widget-got-points','POINTS_AVAILABLE':'antavo-widget-points-available'},isUrl=new RegExp('http(s?):\/\/','gi');function isReady(){return ready;}
function setReady(){ready=true;}
function init(){widgetContainer=document.getElementById('antavo-widget');widgetInner=document.getElementById('antavo-widget-inner');setReady();Antavo.SDK.sendInitEvent();return true;}
function setTemplate(template){var widgetTemplate=template?template:'<div id="antavo-widget" hidden customer=""><a id="antavo-widget-opener"><div id="antavo-widget-inner"></div><div id="antavo-widget-customer-avatar"></div></a></div>';document.getElementsByTagName('body')[0].appendChild(Antavo.DOM.fromString(template));init();return document.getElementById('antavo-widget');}
function setStyle(style){var h=document.getElementsByTagName('head')[0],hs=document.createElement('style');hs.type='text/css';hs.textContent=style;h.appendChild(hs);}
function positionWidget(){if(isReady()){widgetContainer.style.display="";widgetContainer.classList.remove('top-right','bottom-right','bottom-left','top-left','sticky','filled');widgetContainer.removeAttribute('hidden');widgetContainer.classList.add(options.alignment);if(options.attached){widgetContainer.classList.add('sticky');if(options.on_hover===false){widgetContainer.classList.add('filled');widgetContainer.classList.remove('always-on');}}
return true;}else{setTimeout(function(){positionWidget();},500);}}
function setOptions(opts){options=opts;return options;}
function getOptions(){return options;}
function getAlignment(){return{horizontal:options.alignment.substr(options.alignment.indexOf('-')+1),vertical:options.alignment.substr(0,options.alignment.indexOf('-'))}}
function openSidebar(section){var isSectionURL=section&&isUrl.test(section),sectionToLoad=section?section:options.url,frame=getWidgetFrame(),mobile=Antavo.isMobile().any();isUrl.lastIndex=0;if(isSectionURL||typeof section==='undefined'){if(frame.src!=sectionToLoad){frame.src=sectionToLoad;}else{frame.classList.add('open');frame.classList.add(getAlignment().horizontal);return;}}else{if(frame.src!=getSectionUrl(sectionToLoad)){frame.src=getSectionUrl(sectionToLoad);}else{frame.classList.add('open');frame.classList.add(getAlignment().horizontal);return;}}
frame.onload=function(){this.classList.add('open');this.classList.add(getAlignment().horizontal);talker=new Talker(frame.contentWindow,'*');talker.onMessage=function(message){if(message.namespace==='antavoWidgetFrame'){if(message.data.command=='close'){closeSidebar();}
if(message.data.command=='set-cookie'){Antavo.SDK.setOptinCookie(message.data.href);}
if(message.data.command=='unset-cookie'){var alo_cookie=Antavo.Cookie.get('__alo');if(alo_cookie){Antavo.Cookie.expire('__alo',alo_cookie,'/',Antavo.SDK.getTopDomain());talker.send('antavoWidgetFrame',{command:'reload-frame'});}}
if(message.data.command=='failure'){announce('WAIT',[message.data.points,message.data.cooldown]);}
if(message.data.command=='success'){announce('CONGRATS',[message.data.points]);}}};if(mobile!==null&&typeof mobile!=='undefined'){this.contentDocument.body.classList.add('mobile');}
if(options.alignment==='top-left'||options.alignment==='bottom-left'){this.contentDocument.body.classList.add('left');}
this.onload=null;};sidebarOpen=true;}
function lottery(){return options.chance>=Math.floor(Math.random()*100)+1;}
function storeLotteryResult(){var display;if(lotteryDrawn){return true;}
lotteryDrawn=true;if(!Antavo.Cookie.get('__awd')){console.info('No previous result found, getting a new one.');display=lottery();Antavo.Cookie.set('__awd',display?1:0,2629743,'/',getTopDomain());options.display=display;console.info('And the result is:',options.display);if(!!options.display||Antavo.SDK.getCustomer()){recommendReward();}
return!!options.display;}
console.info('Found previous result, getting the cookie...');options.display=!!parseInt(Antavo.Cookie.get('__awd'));console.info('And the result is:',options.display);if(!!options.display||Antavo.SDK.getCustomer()){recommendReward();}
return!!options.display;}
function shouldDisplayReward(){if(Antavo.SDK.getCustomer()){return true;}
if(options.display){return parseInt(100 / options.frequency)>=Math.floor(Math.random()*100)+1;}
return false;}
function getTopDomain(){return location.hostname.indexOf('.co.uk')>-1?location.hostname.split('.').slice(-3).join('.'):location.hostname.split('.').slice(-2).join('.');}
function recommendReward(){if(shouldDisplayReward()&&!recommended&&!ongoingQuiz&&!polledReward){polledReward=true;Antavo.AJAX.get(options.url+'/rewards/recommended',function(response){if(options.display&&typeof response==='object'&&response.hasOwnProperty('id')){storeRecommendedReward(response.id);announce('REWARD',[response]);widgetContainer.onclick=function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();e.canceled=true;openSidebar(options.url);};}},function(err){console.error(err);});}}
function storeRecommendedReward(id){var cookie=Antavo.Cookie.get('__awp');if(cookie){Antavo.Cookie.expire('__awp',cookie,'/',getTopDomain());}
Antavo.Cookie.set('__awp',id,2629743,'/',getTopDomain());}
function closeSidebar(){sidebarOpen=false;getWidgetFrame().classList.remove('open');}
function getSectionUrl(section){return sectionUrls.hasOwnProperty(section)?sectionUrls[section]:false}
function getWidgetFrame(target){var properWindow=target?target:window.parent;return properWindow.document.getElementById(selectors.widgetFrame)?properWindow.document.getElementById(selectors.widgetFrame):createWidgetFrame();}
function createWidgetFrame(target){var properWindow=target?target:window.parent,doc=properWindow.document,frame=doc.createElement('IFRAME');frame.setAttribute('id',selectors.widgetFrame);frame.classList.add(getAlignment().horizontal);return doc.body.appendChild(frame);}
function update(e){if((e.hasOwnProperty('status')&&(e.status=='opted_out'||e.status=='banned'))||Antavo.isMobile().any()){return false;}
if(Antavo.SDK.getBrandUrl()){widgetContainer.setAttribute('customer',e.handler?e.handler:(e.first_name?e.first_name:'Anonymous'));if(e.image_url){document.getElementById('antavo-widget-customer-avatar').style.backgroundImage='url('+e.image_url+')';}
if(Antavo.SDK.getOption('widget','enabled')&&1==2){widgetContainer.classList.add('show');}
if(Antavo.SDK.isWidgetEnabled()&&!ongoingQuiz){recommendReward();}
if(Antavo.SDK.getOption('widget','quiz')&&!polled){var visitURL=new Antavo.URL(window.parent.location.href),hasAlParam=new Antavo.URL(window.parent.location.href).params['__al']==1;polled=true;visitURL.hash=null;visitURL.port=null;delete visitURL.params['__al'];delete visitURL.params['__s'];widgetContainer.onclick=null;Antavo.AJAX.get(Antavo.SDK.getAPIUrl()+'/'+Antavo.SDK.getCustomerId()+'/visit/'+encodeURIComponent(visitURL.toString())+'?api_key='+Antavo.SDK.getAPIKey(),function(e){if(e.hasOwnProperty('quiz')){if(!e.quiz.hasOwnProperty('url')||e.quiz.url===null){return false;}else{ongoingQuiz=true;}
options.display=false;if(!hasAlParam){Antavo.SDK.send('visit',{url:window.parent.location.href});}
if(e.quiz.is_correct===null){announce('POINTS_AVAILABLE',[e.quiz.points]);quiz=e.quiz.url;widgetContainer.onclick=function(){openSidebar(quiz);}}else if(!e.quiz.is_correct){var now=new Date();if(e.quiz.hasOwnProperty('answer_in')){if(e.quiz.answer_in*1000>now.getTime()){announce('WAIT',[e.quiz.points,e.quiz.answer_in]);quiz=e.quiz.url;widgetContainer.onclick=function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();e.canceled=true;openSidebar(quiz);}}}else{announce('POINTS_AVAILABLE',[e.quiz.points]);quiz=e.quiz.url;widgetContainer.onclick=function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();e.canceled=true;openSidebar(quiz);}}}}},function(err){});}}else{setTimeout(function(){update(e);},1000);}}
function announce(type,additional_data){if(Antavo.isMobile().any())return false;var tooltip=widgetContainer.querySelector('.antavo-widget-tooltip');widgetShowing=true;widgetContainer.className='show';positionWidget();if(widgetContainer.querySelector('antavo-widget-tooltip')){widgetContainer.removeChild(widgetContainer.querySelector('.antavo-widget-tooltip'));}
switch(type){case'GOT_POINTS':break;case'CONGRATS':widgetContainer.classList.add('announce');if(tooltip){widgetContainer.removeChild(tooltip);}
widgetInner.innerHTML='';widgetInner.appendChild(Antavo.DOM.fromString('<div class="points-available">'+getCongrats(additional_data[0])+'</div>'));break;case'POINTS_AVAILABLE':widgetContainer.classList.add('announce');if(tooltip){widgetContainer.removeChild(tooltip);}
widgetInner.innerHTML='';widgetInner.appendChild(Antavo.DOM.fromString('<div class="points-available">'+getPointString(additional_data[0])+'</div>'));widgetInner.appendChild(generatePointPattern(additional_data[0]));break;case'WAIT':widgetContainer.classList.add('announce');widgetInner.innerHTML='';widgetInner.appendChild(Antavo.DOM.fromString('<div class="counter">'+Antavo.SDK.getKey('aw_cq_play_again')+'<span id="antavo-widget-counter"></span><em>'+Antavo.SDK.getKey('aw_cq_play_again_postfix')+'</em></div>'));getCounter(additional_data[1]);widgetInner.appendChild(generatePointPattern(additional_data[0]));break;case'REWARD':var reward_data=additional_data[0],reward_img=reward_data.small_image?reward_data.small_image:(reward_data.image_url?reward_data.image_url:Antavo.SDK.getCDNUrl()+'/img/loyalty/rewards/'+reward_data.type+'.svg'),reward_name=reward_data.short_title?reward_data.short_title:reward_data.name;widgetContainer.classList.add('announce','reward');if(!ongoingQuiz){recommended=true;if(options.on_hover===false&&!options.attached){widgetContainer.classList.add('always-on');}
if(tooltip){widgetContainer.removeChild(tooltip);}
widgetContainer.appendChild(Antavo.DOM.fromString('<div class="antavo-widget-tooltip">'+reward_data.name+'</div>'))
widgetInner.innerHTML='';widgetInner.appendChild(Antavo.DOM.fromString('<div class="antavo-widget-graphics" style="background-image:url(\''+reward_img+'\')">'));}
break;default:break;}}
function getCounter(timestamp){var counter=countdown(new Date(),timestamp*1000,countdown.DAYS|countdown.HOURS|countdown.MINUTES|countdown.SECONDS),str='';if(counter.days){str+=counter.days+counter.days>1?'days ':'day ';}
document.getElementById('antavo-widget-counter').innerHTML=str+''+pad(counter.hours,2)+':'+pad(counter.minutes,2)+':'+pad(counter.seconds,2);requestAnimationFrame(function(){getCounter(timestamp);});}
function pad(num,size){var s="000000000"+num;return s.substr(s.length-size);}
function getPointString(point){return Antavo.SDK.getKey('aw_cq_get_x_points').replace(/(%s)/gmi,point);}
function getCongrats(point){return Antavo.SDK.getKey('aw_cq_congrats_got_points').replace(/(%s)/gmi,point);}
function generatePointPattern(point){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),cw=canvas.width,ch=canvas.height,density=40,sizeSet=[12,10,32,14,16,22,48,13,24,15,9];canvas.width=70;canvas.height=70;for(var i=0;i<density;i++){var seed=Math.round(Math.random()*10);ctx.font=sizeSet[seed]+'px Arial Black';ctx.fillStyle='rgba(255,255,255,'+Math.random().toFixed(2)+')';ctx.fillText(point,getRandomInt(0,80),getRandomInt(0,80));}
return canvas;}
function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min;}
function initEventListeners(){document.addEventListener('click',function(e){if(Antavo.DOM.closest(e.target,'[data-opt-in]')){e.preventDefault();Antavo.SDK.setOptinCookie();}})}
function isWidgetShowing(){return widgetShowing?getAlignment():false;}
function isSidebarOpen(){return sidebarOpen;}
initEventListeners();return{isWidgetShowing:isWidgetShowing,isSidebarOpen:isSidebarOpen,setTemplate:setTemplate,setStyle:setStyle,update:update,openSidebar:openSidebar,closeSidebar:closeSidebar,setOptions:setOptions,getOptions:getOptions,positionWidget:positionWidget,storeLotteryResult:storeLotteryResult,events:events,announce:announce,isReady:isReady};})(Antavo);(function(){/*!
 * © 2014 Second Street, MIT License <http://opensource.org/licenses/MIT>
 * Talker.js 1.0.1 <http://github.com/secondstreet/talker.js>
 */
var TALKER_TYPE="application/x-talkerjs-v1+json",TALKER_ERR_TIMEOUT="timeout",pinkySwearPromise=function(){function a(a){return"function"==typeof a}function b(a){return"object"==typeof a}function c(a){"undefined"!=typeof setImmediate?setImmediate(a):"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}var d;return function e(){var f,g=[],h=[],i=function(a,b){return null==f&&null!=a&&(f=a,g=b,h.length&&c(function(){for(var a=0;h.length>a;a++)h[a]()})),f};return i.then=function(i,j){var k=e(),l=function(){function c(e){var f,g=0;try{if(e&&(b(e)||a(e))&&a(f=e.then)){if(e===k)throw new TypeError;f.call(e,function(){g++||c.apply(d,arguments)},function(a){g++||k(!1,[a])})}else k(!0,arguments)}catch(h){g++||k(!1,[h])}}try{var e=f?i:j;a(e)?c(e.apply(d,g||[])):k(f,g)}catch(h){k(!1,[h])}};return null!=f?c(l):h.push(l),k},i}}(),objectCreate=function(a){function b(){}return b.prototype=a,new b},Talker=function(a,b){this.remoteWindow=a,this.remoteOrigin=b,this.timeout=3e3,this.handshaken=!1,this.handshake=pinkySwearPromise(),this._id=0,this._queue=[],this._sent={};var c=this;return window.addEventListener("message",function(a){c._receiveMessage(a)},!1),this._sendHandshake(),this};Talker.prototype.send=function(a,b,c){var d=new Talker.OutgoingMessage(this,a,b,c),e=pinkySwearPromise();return this._sent[d.id]=e,this._queue.push(d),this._flushQueue(),setTimeout(function(){e(!1,[new Error(TALKER_ERR_TIMEOUT)])},this.timeout),e},Talker.prototype._receiveMessage=function(a){var b,c;try{b=JSON.parse(a.data)}catch(d){b={}}return this._isSafeMessage(a.source,a.origin,b.type)?(c=b.handshake||b.handshakeConfirmation,c?this._handleHandshake(b):this._handleMessage(b)):!1},Talker.prototype._isSafeMessage=function(a,b,c){var d,e,f;return d=a===this.remoteWindow,e="*"===this.remoteOrigin||b===this.remoteOrigin,f=c===TALKER_TYPE,d&&e&&f},Talker.prototype._handleHandshake=function(a){a.handshake&&this._sendHandshake(this.handshaken),this.handshaken=!0,this.handshake(!0,[this.handshaken]),this._flushQueue()},Talker.prototype._handleMessage=function(a){var b=new Talker.IncomingMessage(this,a.namespace,a.data,a.id),c=a.responseToId;return c?this._respondToMessage(c,b):this._broadcastMessage(b)},Talker.prototype._respondToMessage=function(a,b){this._sent[a]&&(this._sent[a](!0,[b]),delete this._sent[a])},Talker.prototype._broadcastMessage=function(a){this.onMessage&&this.onMessage.call(this,a)},Talker.prototype._sendHandshake=function(a){var b={type:TALKER_TYPE},c=a?"handshakeConfirmation":"handshake";b[c]=!0,this._postMessage(b)},Talker.prototype._nextId=function(){return this._id+=1},Talker.prototype._postMessage=function(a){this.remoteWindow&&this.remoteOrigin&&this.remoteWindow.postMessage(JSON.stringify(a),this.remoteOrigin)},Talker.prototype._flushQueue=function(){if(this.handshaken){var a=this._queue.shift();if(!a)return this._queue;if(this._postMessage(a),this._queue.length>0)return this._flushQueue()}return this._queue},Talker.Message=function(a,b,c){return this.talker=a,this.namespace=b,this.data=c,this.type=TALKER_TYPE,this},Talker.OutgoingMessage=function(a,b,c,d){Talker.Message.call(this,a,b,c),this.responseToId=d||null,this.id=this.talker._nextId()},Talker.OutgoingMessage.prototype=objectCreate(Talker.Message.prototype),Talker.OutgoingMessage.prototype.constructor=Talker.Message,Talker.OutgoingMessage.prototype.toJSON=function(){return{id:this.id,responseToId:this.responseToId,namespace:this.namespace,data:this.data,type:this.type}},Talker.IncomingMessage=function(a,b,c,d){Talker.Message.call(this,a,b,c),this.id=d},Talker.IncomingMessage.prototype=objectCreate(Talker.Message.prototype),Talker.IncomingMessage.prototype.constructor=Talker.Message,Talker.IncomingMessage.prototype.respond=function(a){return this.talker.send(null,a,this.id)};window.Talker=Talker})()
var module,countdown=function(v){function A(a,b){var c=a.getTime();a.setMonth(a.getMonth()+b);return Math.round((a.getTime()-c)/864E5)}function w(a){var b=a.getTime(),c=new Date(b);c.setMonth(a.getMonth()+1);return Math.round((c.getTime()-b)/864E5)}function x(a,b){b=b instanceof Date||null!==b&&isFinite(b)?new Date(+b):new Date;if(!a)return b;var c=+a.value||0;if(c)return b.setTime(b.getTime()+c),b;(c=+a.milliseconds||0)&&b.setMilliseconds(b.getMilliseconds()+c);(c=+a.seconds||0)&&b.setSeconds(b.getSeconds()+
c);(c=+a.minutes||0)&&b.setMinutes(b.getMinutes()+c);(c=+a.hours||0)&&b.setHours(b.getHours()+c);(c=+a.weeks||0)&&(c*=7);(c+=+a.days||0)&&b.setDate(b.getDate()+c);(c=+a.months||0)&&b.setMonth(b.getMonth()+c);(c=+a.millennia||0)&&(c*=10);(c+=+a.centuries||0)&&(c*=10);(c+=+a.decades||0)&&(c*=10);(c+=+a.years||0)&&b.setFullYear(b.getFullYear()+c);return b}function D(a,b){return y(a)+(1===a?p[b]:q[b])}function n(){}function k(a,b,c,e,l,d){0<=a[c]&&(b+=a[c],delete a[c]);b/=l;if(1>=b+1)return 0;if(0<=a[e]){a[e]=+(a[e]+b).toFixed(d);switch(e){case"seconds":if(60!==a.seconds||isNaN(a.minutes))break;a.minutes++;a.seconds=0;case"minutes":if(60!==a.minutes||isNaN(a.hours))break;a.hours++;a.minutes=0;case"hours":if(24!==a.hours||isNaN(a.days))break;a.days++;a.hours=0;case"days":if(7!==a.days||isNaN(a.weeks))break;a.weeks++;a.days=0;case"weeks":if(a.weeks!==w(a.refMonth)/7||isNaN(a.months))break;a.months++;a.weeks=0;case"months":if(12!==a.months||isNaN(a.years))break;a.years++;a.months=0;case"years":if(10!==a.years||isNaN(a.decades))break;a.decades++;a.years=0;case"decades":if(10!==a.decades||isNaN(a.centuries))break;a.centuries++;a.decades=0;case"centuries":if(10!==a.centuries||isNaN(a.millennia))break;a.millennia++;a.centuries=0}return 0}return b}function B(a,b,c,e,l,d){var f=new Date;a.start=b=b||f;a.end=c=c||f;a.units=e;a.value=c.getTime()-b.getTime();0>a.value&&(f=c,c=b,b=f);a.refMonth=new Date(b.getFullYear(),b.getMonth(),15,12,0,0);try{a.millennia=0;a.centuries=0;a.decades=0;a.years=c.getFullYear()-
b.getFullYear();a.months=c.getMonth()-b.getMonth();a.weeks=0;a.days=c.getDate()-b.getDate();a.hours=c.getHours()-b.getHours();a.minutes=c.getMinutes()-b.getMinutes();a.seconds=c.getSeconds()-b.getSeconds();a.milliseconds=c.getMilliseconds()-b.getMilliseconds();var g;0>a.milliseconds?(g=s(-a.milliseconds/1E3),a.seconds-=g,a.milliseconds+=1E3*g):1E3<=a.milliseconds&&(a.seconds+=m(a.milliseconds/1E3),a.milliseconds%=1E3);0>a.seconds?(g=s(-a.seconds/60),a.minutes-=g,a.seconds+=60*g):60<=a.seconds&&(a.minutes+=m(a.seconds/60),a.seconds%=60);0>a.minutes?(g=s(-a.minutes/60),a.hours-=g,a.minutes+=60*g):60<=a.minutes&&(a.hours+=m(a.minutes/60),a.minutes%=60);0>a.hours?(g=s(-a.hours/24),a.days-=g,a.hours+=24*g):24<=a.hours&&(a.days+=m(a.hours/24),a.hours%=24);for(;0>a.days;)a.months--,a.days+=A(a.refMonth,1);7<=a.days&&(a.weeks+=m(a.days/7),a.days%=7);0>a.months?(g=s(-a.months/12),a.years-=g,a.months+=12*g):12<=a.months&&(a.years+=m(a.months/12),a.months%=12);10<=a.years&&(a.decades+=m(a.years/10),a.years%=10,10<=a.decades&&(a.centuries+=m(a.decades/10),a.decades%=10,10<=a.centuries&&(a.millennia+=m(a.centuries/10),a.centuries%=10)));b=0;!(e&1024)||b>=l?(a.centuries+=10*a.millennia,delete a.millennia):a.millennia&&b++;!(e&512)||b>=l?(a.decades+=10*a.centuries,delete a.centuries):a.centuries&&b++;!(e&256)||b>=l?(a.years+=10*a.decades,delete a.decades):a.decades&&b++;!(e&128)||b>=l?(a.months+=12*a.years,delete a.years):a.years&&b++;!(e&64)||b>=l?(a.months&&(a.days+=A(a.refMonth,a.months)),delete a.months,7<=a.days&&(a.weeks+=m(a.days/7),a.days%=7)):a.months&&b++;!(e&32)||b>=l?(a.days+=7*a.weeks,delete a.weeks):a.weeks&&b++;!(e&16)||b>=l?(a.hours+=24*a.days,delete a.days):a.days&&b++;!(e&8)||b>=l?(a.minutes+=60*a.hours,delete a.hours):a.hours&&b++;!(e&4)||b>=l?(a.seconds+=60*a.minutes,delete a.minutes):a.minutes&&b++;!(e&2)||b>=l?(a.milliseconds+=1E3*a.seconds,delete a.seconds):a.seconds&&b++;if(!(e&1)||b>=l){var h=k(a,0,"milliseconds","seconds",1E3,d);if(h&&(h=k(a,h,"seconds","minutes",60,d))&&(h=k(a,h,"minutes","hours",60,d))&&(h=k(a,h,"hours","days",24,d))&&(h=k(a,h,"days","weeks",7,d))&&(h=k(a,h,"weeks","months",w(a.refMonth)/7,d))){e=h;var n,p=a.refMonth,q=p.getTime(),r=new Date(q);r.setFullYear(p.getFullYear()+1);n=Math.round((r.getTime()-q)/864E5);if(h=k(a,e,"months","years",n/w(a.refMonth),d))if(h=k(a,h,"years","decades",10,d))if(h=k(a,h,"decades","centuries",10,d))if(h=k(a,h,"centuries","millennia",10,d))throw Error("Fractional unit overflow");}}}finally{delete a.refMonth}return a}
function d(a,b,c,e,d){var f;c=+c||222;e=0<e?e:NaN;d=0<d?20>d?Math.round(d):20:0;var k=null;"function"===typeof a?(f=a,a=null):a instanceof Date||(null!==a&&isFinite(a)?a=new Date(+a):("object"===typeof k&&(k=a),a=null));var g=null;"function"===typeof b?(f=b,b=null):b instanceof Date||(null!==b&&isFinite(b)?b=new Date(+b):("object"===typeof b&&(g=b),b=null));k&&(a=x(k,b));g&&(b=x(g,a));if(!a&&!b)return new n;if(!f)return B(new n,a,b,c,e,d);var k=c&1?1E3/30:c&2?1E3:c&4?6E4:c&8?36E5:c&16?864E5:6048E5,h,g=function(){f(B(new n,a,b,c,e,d),h)};g();return h=setInterval(g,k)}var s=Math.ceil,m=Math.floor,p,q,r,t,u,f,y,z;n.prototype.toString=function(a){var b=z(this),c=b.length;if(!c)return a?""+a:u;if(1===c)return b[0];a=r+b.pop();return b.join(t)+a};n.prototype.toHTML=function(a,b){a=a||"span";var c=z(this),e=c.length;if(!e)return(b=b||u)?"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e":b;for(var d=0;d<e;d++)c[d]="\x3c"+a+"\x3e"+c[d]+"\x3c/"+a+"\x3e";if(1===e)return c[0];e=r+c.pop();return c.join(t)+e};n.prototype.addTo=function(a){return x(this,a)};z=function(a){var b=[],c=a.millennia;c&&b.push(f(c,10));(c=a.centuries)&&b.push(f(c,9));(c=a.decades)&&b.push(f(c,8));(c=a.years)&&b.push(f(c,7));(c=a.months)&&b.push(f(c,6));(c=a.weeks)&&b.push(f(c,5));(c=a.days)&&b.push(f(c,4));(c=a.hours)&&b.push(f(c,3));(c=a.minutes)&&b.push(f(c,2));(c=a.seconds)&&b.push(f(c,1));(c=a.milliseconds)&&b.push(f(c,0));return b};d.MILLISECONDS=1;d.SECONDS=2;d.MINUTES=4;d.HOURS=8;d.DAYS=16;d.WEEKS=32;d.MONTHS=64;d.YEARS=128;d.DECADES=256;d.CENTURIES=512;d.MILLENNIA=1024;d.DEFAULTS=222;d.ALL=2047;var E=d.setFormat=function(a){if(a){if("singular"in a||"plural"in a){var b=a.singular||[];b.split&&(b=b.split("|"));var c=a.plural||[];c.split&&(c=c.split("|"));for(var d=0;10>=d;d++)p[d]=b[d]||p[d],q[d]=c[d]||q[d]}"string"===typeof a.last&&(r=a.last);"string"===typeof a.delim&&(t=a.delim);"string"===typeof a.empty&&(u=a.empty);"function"===typeof a.formatNumber&&(y=a.formatNumber);"function"===typeof a.formatter&&(f=a.formatter)}},C=d.resetFormat=function(){p=" millisecond; second; minute; hour; day; week; month; year; decade; century; millennium".split(";");q=" milliseconds; seconds; minutes; hours; days; weeks; months; years; decades; centuries; millennia".split(";");r=" and ";t=", ";u="";y=function(a){return a};f=D};d.setLabels=function(a,b,c,d,f,k,m){E({singular:a,plural:b,last:c,delim:d,empty:f,formatNumber:k,formatter:m})};d.resetLabels=C;C();v&&v.exports?v.exports=d:"function"===typeof window.define&&"undefined"!==typeof window.define.amd&&window.define("countdown",[],function(){return d});return d}(module);var Antavo=window.Antavo||{};(function(document){'use strict';var frameQuery='#loyalty-center-frame';var talker;function initEventListeners(){var copyClipboard=document.querySelector('[data-copy-button]');if(copyClipboard){var input=document.querySelector('#'+copyClipboard.getAttribute('data-copy-button'))||false;if(input){copyClipboard.addEventListener('click',function(){copyToClipboard(input,copyClipboard);});}}}
function init(){if(Antavo&&Antavo.SDK&&Antavo.SDK.getBrandId()){var frame=document.querySelector('iframe[src*="'+Antavo.SDK.getBrandUrl().replace(/http[s]*:\/\//gm,'')+'"]:not([src*="/share/"]):not([src*="/referral/"])')||document.querySelector(frameQuery),original_url=frame&&frame.getAttribute('src');if(frame){if(window.performance){if(window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD){try{frame.contentWindow.location.reload(true);}catch(e){frame.setAttribute('src','');frame.setAttribute('src',original_url);}}}
talker=new Talker(frame.contentWindow,'*');frame.onload=function(){talker.send('antavoLoyaltyCenter',{command:'content-loaded',mobile:!!Antavo.isMobile().any()});};document.addEventListener('antavo_sdk_init_finished',function(){talker.send('antavoLoyaltyCenter',{command:'content-loaded',mobile:!!Antavo.isMobile().any()});});talker.onMessage=function(message){if(message.namespace==='antavoLoyaltyCenter'){if(message.data.command==='resize-frame'){if(frame.offsetParent!=null&&message.data.height){if(message.data.height>480){frame.style.height=message.data.height+'px';if(message.data.selector&&document.querySelector(message.data.selector)){document.querySelector(message.data.selector).style.height=message.data.height+'px';}}else{frame.style.height='480px';}}
if(frame.offsetParent!=null&&message.data.width){frame.style.width='100%';}}else if(message.data.command==='open-social-share'){Antavo.Popup.display(message.data.url);}else if(message.data.command==='open-raf-share'){var pathUrl=Antavo.SDK.getExtensionInfo('socialshare')?Antavo.SDK.getExtensionInfo('socialshare').url:Antavo.SDK.getExtensionInfo('friendreferral').share_url;if(message.data.network==="facebook"){FB.ui({method:"share",href:message.data.url,display:"iframe"},function(response){if(response){Antavo.SDK.send("share",{network:"facebook",url:message.data.url});Antavo.Popup.display(Antavo.Popup.getShareUrl(Antavo.SDK.getBrandUrl())+'/success');}});}else{Antavo.Popup.display(pathUrl+'/'+message.data.network+'/referral?url='+message.data.url);}}else if(message.data.command==='open-video'){var videoId=message.data.video;if(videoId&&videoId!=undefined){Antavo.Video.openVideo(videoId);}}else if(message.data.command==='get-variable'){sendVariable(getVariable(message.data.variable));}else if(message.data.command==='where-am-i'){talker.send('antavoLoyaltyCenter',{command:'you-are-here',position:frame.getBoundingClientRect()});}else if(message.data.command==='scotty-beam-me-up'){var offset=message.data.offset||0;if(window.jQuery){jQuery('html, body').stop().animate({scrollTop:jQuery(frame).offset().top+offset},1000);}else{console.warn('Sorry, this command needs jQuery to function');}}else if(message.data.command==='inject-element'){var method=message.data.method||'appendChild',selector=message.data.selector||'body',html_string=message.data.html_string,elem=document.querySelector(selector);switch(method){case'appendChild':elem.appendChild(Antavo.DOM.fromString(html_string));break;case'insertBefore':default:elem.parentNode.insertBefore(Antavo.DOM.fromString(html_string),elem);}}else if(message.data.command==='remove-element'){console.info('Got request from inner frame');var content_selector=message.data.content_selector,elem=document.querySelector(content_selector);elem.parentNode.removeChild(elem);}else if(message.data.command==='redirect'){if(message.data.target){window.location=message.data.target;}}}};}
initEventListeners();checkForParameter();}else{setTimeout(function(){init();},1000);}}
function getVariable(vg){return window[vg];}
function sendVariable(vs){talker.send('antavoLoyaltyCenter',{command:'send-variable',variable:vs});}
function submitForm(form_id){console.info('Got the form ID:',form_id);if(talker){talker.send('antavoLoyaltyCenter',{command:'submit-form',form_submit:form_id});}}
function setFrame(newSrc){var frame=document.querySelector(frameQuery);if(frame){frame.src=newSrc;}}
function checkForParameter(){var storedUrl=Antavo.Automation.getStoredURL(),parsedUrl;if(storedUrl&&typeof storedUrl!='undefined'){parsedUrl=new Antavo.URL(storedUrl);if(parsedUrl.params['lc_url']){var newSrc=decodeURIComponent(parsedUrl.params['lc_url']);if(newSrc&&typeof newSrc!='undefined'&&newSrc.length){setFrame(newSrc);}}}}
function copyToClipboard(input,target){var copySupported=document.queryCommandSupported('copy');if(copySupported&&input){input.select();try{var successful=document.execCommand('copy');input.blur();if(target&&successful){target.innerHTML='Copied';}else if(target){target.innerHTML='please press Ctrl/Cmd+C to copy';}}catch(err){if(target){target.innerHTML='please press Ctrl/Cmd+C to copy';}}}}
var LoyaltyCenter={};init();LoyaltyCenter.init=init;LoyaltyCenter.copyToClipboard=copyToClipboard;LoyaltyCenter.submitForm=submitForm;Antavo.LoyaltyCenter=LoyaltyCenter;}(document));var Antavo=window.Antavo||{};(function(document){'use strict';var snippetQuery='.aip-point-display';var propertyTag='data-aip-properties';var summaryTag='data-aip-summary';var valueTag='data-aip-value';var innerTemplate='<div class="aip-point-display-inner"></div>';var messageKey="";var messageKeyName='lc_aip_inner_content';var general_percentage;var campaigns=[];var snippetObject={snippets:[],getSnippets:function(){return this.snippets;},addSnippets:function(elem){this.snippets.push(elem);}};function parse(){var container=document.querySelectorAll(snippetQuery);for(var i=0;i<container.length;i++){if(container[i].hasAttribute(propertyTag)){snippetObject.addSnippets({elem:container[i],points:container[i].getAttribute(valueTag),properties:parseProperties(container[i].getAttribute(propertyTag))});}else{snippetObject.addSnippets({elem:container[i],points:container[i].getAttribute(valueTag)});}}}
function generate(){var snippets=snippetObject.getSnippets(),properties;for(var i=0;i<snippets.length;i++){var elem=snippets[i].elem,points=1;try{points=elem.getAttribute('data-aip-value');}catch(e){}
if(elem.hasAttribute(summaryTag)){}else if(elem.hasAttribute(propertyTag)&&(properties=parseProperties(elem.getAttribute(propertyTag)))){points=properties.value||points;elem.innerHTML=replacePoints(points,checkCampaigns(properties,campaigns));}else{elem.innerHTML=replacePoints(points);}}
generateSummaries();}
function getPointsFromCampaigns(products,campaigns){var pointStrings=[],sum=0;[].forEach.call(products,function(item){var point=calcPoints(item.value,general_percentage,checkCampaigns(item,campaigns));pointStrings.push(replacePoints(item.value,checkCampaigns(item,campaigns)));sum+=Number(point);});pointStrings.push(replacePoints(sum,1,100));return pointStrings;}
function getPoints(products){return getPointsFromCampaigns(products,campaigns);}
function generateSummaries(){var snippets=snippetObject.getSnippets(),groups={};for(var i=0;i<snippets.length;i++){if(snippets[i].hasOwnProperty('properties')&&snippets[i].properties.hasOwnProperty('group')){var properties=snippets[i].properties;groups[properties.group]=groups[properties.group]?groups[properties.group]:0;groups[properties.group]=groups[properties.group]+parseInt(properties.value);}}
for(var group in groups){for(var g=0;g<snippets.length;g++){if(snippets[g].elem.hasAttribute(summaryTag)&&snippets[g].elem.getAttribute(summaryTag)==group){snippets[g].elem.innerHTML=replacePoints(groups[group],1,100);}}}}
function parseProperties(properties){try{return JSON.parse(properties);}catch(e){return false;}}
function checkCampaigns(item,campaigns){for(var i=0;i<campaigns.length;i++){if(checkProperty(item,campaigns[i])){return campaigns[i].multiplier;}}
return 1;}
function checkProperty(item,campaign){return isValid(item[campaign.property],campaign.operator,campaign.value);}
function isValid(x,op,y){switch(op){case'start':return isStartWith(x,y);break;case'not_start':return isNotStartWith(x,y);break;case'end':return isEndWith(x,y);break;case'not_end':return isNotEndWith(x,y);break;case'contain':return isContains(x,y);break;case'not_contain':return isNotContains(x,y);break;case'equal':return isEqual(x,y);break;case'not_equal':return isNotEqual(x,y);break;case'less':return isLessThan(x,y);break;case'not_greater':return isLessThanEquals(x,y);break;case'greater':return isGreaterThan(x,y);break;case'not_less':return isGreaterThanEquals(x,y);break;case'between':return isBetween(x,y);break;case'exists':return isExists(x,y);break;case'not_exists':return isNotExists(x,y);break;default:console.error('Unsupported operator type:'+op);break;}}
function isEqual(x,y){return x===y;}
function isNotEqual(x,y){return!isEqual(x,y);}
function isStartWith(x,y){return Boolean(x.match('^('+y+')'));}
function isNotStartWith(x,y){return!isStartWith(x,y);}
function isEndWith(x,y){return Boolean(x.match('('+y+'$)'));}
function isNotEndWith(x,y){return!isEndWith(x,y);}
function isGreaterThan(x,y){return x>y;}
function isLessThan(x,y){return x<y;}
function isGreaterThanEquals(x,y){return x>=y;}
function isLessThanEquals(x,y){return x<=y;}
function isBetween(value,interval){return value>=interval[0]&&value<=interval[1];}
function isContains(x,y){return x.indexOf(y)!=-1;}
function isNotContains(x,y){return!isContains(x,y);}
function isExists(x,y){return x!=null&&typeof x!='undefined'&&x!='';}
function isNotExists(x,y){return!isExists(x,y);}
function replacePoints(points,multiplier,percentage){var mult=multiplier||1,perc=percentage||general_percentage;if(!messageKey){messageKey=Antavo.SDK.getKey(messageKeyName);}
return messageKey.replace(/%d/g,calcPoints(points,perc,mult));}
function calcPoints(points,percentage,multiplier){return(multiplier*(points*(percentage / 100))).toFixed();}
function reflow(){parse();generate();}
function clear(wipe){var snippets=snippetObject.getSnippets();for(var i;i<snippets.length;i++){var elem=snippets[i].elem;elem.innerHTML='';if(wipe&&elem.parentNode!=null){elem.parentNode.removeChild(elem);}}}
function setStyle(style){var head=document.head,styleContainer=document.createElement('style');styleContainer.setAttribute('id','aip-custom-stylesheet');styleContainer.innerHTML=style;head.appendChild(styleContainer);}
function parseCampaigns(campaignResponse){var campaigns=[];if(campaignResponse instanceof Array&&campaignResponse.length>0){for(var i=0;i<campaignResponse.length;i++){campaigns.push(campaignResponse[i]);}}
return campaigns;}
function init(){if(Antavo.SDK.getBrandId()){if(Antavo.SDK.getExtensionInfo('incentivizedpurchase')){messageKey=Antavo.SDK.getKey(messageKeyName);general_percentage=Antavo.SDK.getExtensionInfo('incentivizedpurchase','percentage');campaigns=parseCampaigns(Antavo.SDK.getExtensionInfo('incentivizedpurchase','campaigns'));reflow();}}else{window.setTimeout(init,1000);}}
var AIP={};AIP.init=init;AIP.reflow=reflow;AIP.clear=clear;AIP.setStyle=setStyle;AIP.getPoints=getPoints;Antavo.IncentivizedPurchase=AIP;}(document));var Antavo=window.Antavo||{};(function(document){'use strict';var widgetTemplate='<div class="antavo-quiz-widget antavo-hidden"><a href="#" data-open-quiz-popup="#"><p data-quiz-widget-text>Take the quiz</p><p data-quiz-widget-points>get 30 points</p></a></div>';var quizDisplayed=false;function injectTemplate(template){return document.getElementsByTagName('body')[0].appendChild(Antavo.DOM.fromString(template));}
function showQuiz(points,link){var quizWidget;if(!document.querySelector('.antavo-quiz-widget')){injectTemplate(widgetTemplate);}
quizWidget=document.querySelector('.antavo-quiz-widget');if(quizWidget){var url=quizWidget.querySelector('[data-open-quiz-popup]'),textContainer=quizWidget.querySelector('[data-quiz-widget-text]'),text=Antavo.SDK.getKey('lc_quiz_take_quiz')||'Take our quiz',pointsString=Antavo.SDK.getKey('lc_quiz_get_points')||'Get %s points!',pointsContainer=quizWidget.querySelector('[data-quiz-widget-points]');if(url&&textContainer&&points){url.setAttribute('data-open-quiz-popup',link);textContainer.innerHTML=text;if(pointsContainer&&pointsString.match(/%s/)){pointsContainer.innerHTML=pointsString.replace(/%s/,points);}
quizWidget.classList.remove('antavo-hidden');initEventListeners();quizDisplayed=true;}}}
function hideQuiz(){var quizWidget=document.querySelector('.antavo-quiz-widget');if(quizWidget){quizWidget.classList.add('antavo-hidden');}}
function initEventListeners(){document.addEventListener('click',function(e){if(Antavo.DOM.closest(e.target,'[data-open-quiz-popup]')){var link=Antavo.DOM.closest(e.target,'[data-open-quiz-popup]');Antavo.Popup.display(link.getAttribute('data-open-quiz-popup').toString());}})}
function checkForQuiz(){if(Antavo.SDK.getCustomer()&&Antavo.SDK.getExtensionInfo('contentconsumption','quiz_url')){var extension=Antavo.SDK.getExtensionInfo('contentconsumption');if(extension.visit&&extension.quiz_url){document.addEventListener('scroll',function(){var bodyScrollTop=document.documentElement.scrollTop||document.body.scrollTop;if(!quizDisplayed&&bodyScrollTop>=(document.body.clientHeight-window.innerHeight)*0.5){showQuiz(extension.visit,extension.quiz_url);}});}}}
function checkForExtension(){if(Antavo.SDK&&Antavo.SDK.getBrandId()){if(Antavo.SDK.getExtensionInfo('contentconsumption')){checkForQuiz();}}else{setTimeout(function(){checkForExtension();},1000);}}
function init(){document.addEventListener('antavo_sdk_init_finished',function(){checkForExtension();});}
init();var Quiz={};Quiz.init=init;Quiz.hide=hideQuiz;Antavo.Quiz=Quiz;}(document));var Antavo=window.Antavo||{};Antavo.tresureHunting=(function(){function init(){if(Antavo.SDK.getBrandId()){var treasureHunt=Antavo.SDK.getExtensionInfo('treasure_hunt');if(treasureHunt){var currentUrl=location.protocol+'//'+location.host+location.pathname;for(var i=0;i<treasureHunt.length;i++){if(treasureHunt[i].url===currentUrl){Antavo.SDK.send("treasure_found",{"treasure_id":treasureHunt[i]._id});Antavo.AJAX.post(Antavo.SDK.getAPIUrl(),{'api_key':Antavo.SDK.getAPIKey(),'customer':Antavo.SDK.getCustomerId(),'action':'treasure_found','data':{"treasure_id":treasureHunt[i]._id}||{}},function(){Antavo.Toast.show(treasureHunt[i].success_message);});break;}}}}else{setTimeout(init,1000);}}
return{init:init};})(Antavo,document);Antavo.tresureHunting.init();Antavo.Video.injectTemplate('<div id="tpl-remaining-box" class="antavo-remaining-box antavo-hidden" style="opacity: 0; display: none;"> <div class="antavo-remaining-box-main-block antavo-counting loggedin antavo-hidden"> <!-- Logged in customer --> <div class="antavo-arrow-box-left"> <span> <img id="antavo-remaining-box-image" src=""><span id="antavo-remaining-box-name"></span> </span> </div> <div class="antavo-remaining-box-counter"> <span id="remaining-time"><strong></strong> and you will get your points</span> </div> <div class="antavo-remaining-box-pointer-pentagon"> <span> <strong><span id="antavo-remaining-box-point-value">50</span></strong> <p class="antavo-remaining-box-point" id="antavo-remaining-box-point-label">kredit</p> </span> </div> </div> <div class="antavo-remaining-box-main-block antavo-counting guest antavo-hidden"> <!-- Guest --> <div class="antavo-remaining-box-pointer-pentagon-left"> <span> <strong> <span id="antavo-remaining-box-point-value2">50</span> </strong> <p class="antavo-remaining-box-point" id="antavo-remaining-box-point-label2"></p> </span> </div> <div class="antavo-remaining-box-counter"> <span id="remaining-time2"> <strong></strong> </span> </div> <div class="antavo-arrow-box-right"> <span> <a id="antavo-remaining-box-login-url" href=""> <strong id="antavo-remaining-box-login-link"></strong> </a> </span> </div> </div> <div class="antavo-remaining-box-main-block antavo-successful antavo-hidden"> <!-- Successfully/Already watched video --> <div class="success-wrapper"> <!-- Place success message here --> </div> </div> </div>');Antavo.Video.injectTemplate('<template id="tpl-video-frame"> <div id="antavo-loyalty-video-dialog"> <a data-close-video-dialog>×</a> <div class="flex-video"> {{content}} </div> </div> </template>');Antavo.Widget.setStyle('/** * Vendor prefix mixin * --- * Specify the property name (can be unqouted) and the value (quoted) * and this mixin takes care of the rest. * */ @import url("https://fonts.googleapis.com/css?family=Roboto:100,300,400,700"); .widget-body, .widget-body .widget-section, .widget-body article { margin: 0; padding: 0; height: 100%; overflow: hidden; } #antavo-widget-frame { background-color: transparent; border: 0; border-left: 0; width: 340px; height: 100%; top: 0; right: 0; position: fixed; transition: all 0.75s ease-in-out; -webkit-transform: translateX(500px); -ms-transform: translateX(500px); -moz-transform: translateX(500px); -o-transform: translateX(500px); transform: translateX(500px); will-change: transform; z-index: 2147483646; } #antavo-widget-frame.open { -webkit-transform: translateX(0); -ms-transform: translateX(0); -moz-transform: translateX(0); -o-transform: translateX(0); transform: translateX(0); } #antavo-widget-frame.open.left { left: 0; -webkit-transform: translateX(0); -ms-transform: translateX(0); -moz-transform: translateX(0); -o-transform: translateX(0); transform: translateX(0); } #antavo-widget-frame.left { right: auto; left: 0; -webkit-transform: translateX(-500px); -ms-transform: translateX(-500px); -moz-transform: translateX(-500px); -o-transform: translateX(-500px); transform: translateX(-500px); } #antavo-widget { background-size: cover; position: fixed; cursor: pointer; top: 30px; right: 46px; border: 5px solid #FFF; border-radius: 50%; box-sizing: border-box; display: block; width: 80px; height: 80px; transition: all .25s ease-in; opacity: 0; -webkit-transform: scale(0); -ms-transform: scale(0); -moz-transform: scale(0); -o-transform: scale(0); transform: scale(0); z-index: 2147483645; box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.2); } #antavo-widget.bottom-left .antavo-widget-tooltip, #antavo-widget.top-left .antavo-widget-tooltip { left: calc(100% + 8px); right: auto; } #antavo-widget.bottom-left .antavo-widget-tooltip:after, #antavo-widget.top-left .antavo-widget-tooltip:after { right: 100%; left: auto; border-color: rgba(43, 43, 43, 0); border-right-color: #2b2b2b; } #antavo-widget.always-on.bottom-left .antavo-widget-tooltip, #antavo-widget.always-on.bottom-right .antavo-widget-tooltip { -webkit-transform: translateY(calc(-100% - 16px)) translateX(-50%); -ms-transform: translateY(calc(-100% - 16px)) translateX(-50%); -moz-transform: translateY(calc(-100% - 16px)) translateX(-50%); -o-transform: translateY(calc(-100% - 16px)) translateX(-50%); transform: translateY(calc(-100% - 16px)) translateX(-50%); top: 0; bottom: auto; } #antavo-widget.always-on .antavo-widget-tooltip { left: 50%; display: block !important; -webkit-transform: translateY(calc(100% + 16px)) translateX(-50%); -ms-transform: translateY(calc(100% + 16px)) translateX(-50%); -moz-transform: translateY(calc(100% + 16px)) translateX(-50%); -o-transform: translateY(calc(100% + 16px)) translateX(-50%); transform: translateY(calc(100% + 16px)) translateX(-50%); width: 100px; text-align: center; bottom: 0; top: auto; right: auto; } #antavo-widget.always-on .antavo-widget-tooltip:after { display: none; } #antavo-widget:hover .antavo-widget-tooltip { display: block; } #antavo-widget.reward:after { display: none; } #antavo-widget .antavo-widget-tooltip { position: absolute; display: none; width: 200px; right: 80px; background: #2b2b2b; color: #FFF; font-size: 10px; line-height: 14px; padding: 8px; top: 50%; -webkit-transform: translateY(-50%); -ms-transform: translateY(-50%); -moz-transform: translateY(-50%); -o-transform: translateY(-50%); transform: translateY(-50%); } #antavo-widget .antavo-widget-tooltip:after { left: 100%; top: 50%; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; border-color: rgba(43, 43, 43, 0); border-left-color: #2b2b2b; border-width: 5px; margin-top: -5px; } #antavo-widget a { position: relative; width: 100%; height: 100%; display: block; } #antavo-widget:after { position: absolute; content: attr(customer); display: block; height: 16px; border-radius: 8px; background-color: #000; color: #FFF; text-align: center; font-size: 10px; font-family: Arial, Helvetica, sans-serif; box-sizing: border-box; width: auto; left: 50%; -webkit-transform: translateX(-50%); -ms-transform: translateX(-50%); -moz-transform: translateX(-50%); -o-transform: translateX(-50%); transform: translateX(-50%); text-transform: uppercase; bottom: -16px; padding-left: 12px; padding-right: 12px; max-width: 90px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } #antavo-widget.show { opacity: 1; -webkit-transform: scale(1); -ms-transform: scale(1); -moz-transform: scale(1); -o-transform: scale(1); transform: scale(1); } #antavo-widget.bottom-right { bottom: 30px; right: 46px; top: auto; } #antavo-widget.bottom-left { bottom: 30px; right: auto; left: 46px; top: auto; } #antavo-widget.top-left { top: 30px; right: auto; left: 46px; } #antavo-widget.announce { background: #f86702; background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2Y4NjcwMiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNmMjNjMDkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+); background: -moz-linear-gradient(top, #f86702 0%, #f23c09 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #f86702), color-stop(100%, #f23c09)); background: -webkit-linear-gradient(top, #f86702 0%, #f23c09 100%); background: -o-linear-gradient(top, #f86702 0%, #f23c09 100%); background: -ms-linear-gradient(top, #f86702 0%, #f23c09 100%); background: linear-gradient(to bottom, #f86702 0%, #f23c09 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#f86702\', endColorstr=\'#f23c09\',GradientType=0 ); } #antavo-widget.announce #antavo-widget-customer-avatar { -webkit-transform: scale(0) rotate(180deg); -ms-transform: scale(0) rotate(180deg); -moz-transform: scale(0) rotate(180deg); -o-transform: scale(0) rotate(180deg); transform: scale(0) rotate(180deg); } #antavo-widget.sticky { background: #9cd5cd; border-radius: 12px; padding: 10px; height: 100px; width: 100px; border: 0; } #antavo-widget.sticky .antavo-widget-tooltip { background: #81bfb7; border-radius: 6px; } #antavo-widget.sticky .antavo-widget-tooltip:after { border-left-color: #81bfb7; } #antavo-widget.sticky.top-right, #antavo-widget.sticky.bottom-right { right: 0; border-top-right-radius: 0; border-bottom-right-radius: 0; } #antavo-widget.sticky.top-right .antavo-widget-tooltip, #antavo-widget.sticky.bottom-right .antavo-widget-tooltip { right: 110px; } #antavo-widget.sticky.top-left, #antavo-widget.sticky.bottom-left { left: 0; border-top-left-radius: 0; border-bottom-left-radius: 0; } #antavo-widget.sticky.top-left .antavo-widget-tooltip:after, #antavo-widget.sticky.bottom-left .antavo-widget-tooltip:after { border-left-color: transparent; border-right-color: #81BFB7; } #antavo-widget.sticky #antavo-widget-inner { width: 80px; height: 80px; border: 6px solid #fff; box-sizing: border-box; } #antavo-widget.sticky.filled .antavo-widget-tooltip { display: block; position: absolute; top: 100%; left: 0; width: 100%; right: 10px; word-wrap: break-word; border-top-left-radius: 0; border-top-right-radius: 0; -webkit-transform: translate( 0, 0); -ms-transform: translate( 0, 0); -moz-transform: translate( 0, 0); -o-transform: translate( 0, 0); transform: translate( 0, 0); } #antavo-widget.sticky.filled .antavo-widget-tooltip:after { content: none; } #antavo-widget.sticky.filled.top-right, #antavo-widget.sticky.filled.bottom-right { border-bottom-left-radius: 0; } #antavo-widget.sticky.filled.top-right .antavo-widget-tooltip, #antavo-widget.sticky.filled.bottom-right .antavo-widget-tooltip { left: 0; right: 0; border-bottom-right-radius: 0; } #antavo-widget.sticky.filled.top-left, #antavo-widget.sticky.filled.bottom-left { border-bottom-right-radius: 0; } #antavo-widget.sticky.filled.top-left .antavo-widget-tooltip, #antavo-widget.sticky.filled.bottom-left .antavo-widget-tooltip { right: 0; left: 0; border-bottom-left-radius: 0; } #antavo-widget-customer-avatar { background-size: cover; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border-radius: 50%; -webkit-transition: all 0.75s ease-in-out; -ms-transition: all 0.75s ease-in-out; -moz-transition: all 0.75s ease-in-out; -o-transition: all 0.75s ease-in-out; transition: all 0.75s ease-in-out; } #antavo-widget-inner { width: 70px; height: 70px; border-radius: 50%; overflow: hidden; } #antavo-widget-inner .antavo-widget-graphics { width: 100%; height: 100%; background-size: cover; background-position: 50% 0; background-repeat: no-repeat; } #antavo-widget-inner .points-available, #antavo-widget-inner .counter { color: #FFF; font-size: 12px; line-height: 14px; left: 0; position: absolute; text-align: center; text-transform: uppercase; top: 50%; width: 100%; -webkit-transform: translateY(-50%); -ms-transform: translateY(-50%); -moz-transform: translateY(-50%); -o-transform: translateY(-50%); transform: translateY(-50%); } #antavo-widget-inner .points-available span, #antavo-widget-inner .counter span { display: block; font-weight: 700; font-size: 24px; line-height: 24px; } #antavo-widget-inner .points-available.counter, #antavo-widget-inner .counter.counter { font-size: 10px; line-height: 12px; top: 8px; height: 100%; -webkit-transform: translateY(0); -ms-transform: translateY(0); -moz-transform: translateY(0); -o-transform: translateY(0); transform: translateY(0); } #antavo-widget-inner .points-available.counter span, #antavo-widget-inner .counter.counter span { background: #f86702; border-radius: 12px; font-size: 16px; line-height: 16px; position: absolute; left: 50%; padding: 4px 12px; -webkit-transform: translateX(-50%); -ms-transform: translateX(-50%); -moz-transform: translateX(-50%); -o-transform: translateX(-50%); transform: translateX(-50%); white-space: nowrap; } #antavo-widget-inner .points-available.counter em, #antavo-widget-inner .counter.counter em { color: #FFF; display: inline-block; font-style: normal; position: absolute; bottom: 12px; left: 50%; -webkit-transform: translateX(-50%); -moz-transform: translateX(-50%); -ms-transform: translateX(-50%); -o-transform: translateX(-50%); transform: translateX(-50%); } #antavo-widget-inner canvas { border-radius: 50%; opacity: .3; -webkit-animation-name: spin; -ms-animation-name: spin; -moz-animation-name: spin; -o-animation-name: spin; animation-name: spin; -webkit-animation-duration: 10s; -ms-animation-duration: 10s; -moz-animation-duration: 10s; -o-animation-duration: 10s; animation-duration: 10s; -webkit-animation-fill-mode: both; -ms-animation-fill-mode: both; -moz-animation-fill-mode: both; -o-animation-fill-mode: both; animation-fill-mode: both; -webkit-animation-iteration-count: infinite; -ms-animation-iteration-count: infinite; -moz-animation-iteration-count: infinite; -o-animation-iteration-count: infinite; animation-iteration-count: infinite; } /* Animations */ @-moz-keyframes spin { from { -moz-transform: rotate(0deg); } to { -moz-transform: rotate(360deg); } } @-webkit-keyframes spin { from { -webkit-transform: rotate(0deg); } to { -webkit-transform: rotate(360deg); } } @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } @media (max-device-width: 640px) { #antavo-widget-frame { width: 100%; } } /*# sourceMappingURL=widget.css.map */');Antavo.Widget.setTemplate('<div id="antavo-widget" hidden customer=""><a id="antavo-widget-opener"><div id="antavo-widget-inner"></div><div id="antavo-widget-customer-avatar"></div></a></div>')